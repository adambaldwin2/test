<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Halberd.clues.analysis</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css"></link>
</head>
<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">

<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="Halberd-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <font size="-1"><b class="breadcrumbs">
        <a href="Halberd-module.html">Package&nbsp;Halberd</a> ::
        <a href="Halberd.clues-module.html">Package&nbsp;clues</a> ::
        Module&nbsp;analysis
      </b></font></br>
    </td>
    <td><table cellpadding="0" cellspacing="0">
      <tr><td align="right"><font size="-2">[<a href="../private/Halberd.clues.analysis-module.html">show&nbsp;private</a>&nbsp;|&nbsp;hide&nbsp;private]</font></td></tr>
      <tr><td align="right"><font size="-2">[<a href="frames.html"target="_top">frames</a>&nbsp;|&nbsp;<a href="Halberd.clues.analysis-module.html" target="_top">no&nbsp;frames</a>]</font></td></tr>
    </table></td>
</tr></table>

<!-- =========== START OF MODULE DESCRIPTION =========== -->
<h2 class="module">Module Halberd.clues.analysis</h2>

Utilities for clue analysis.
<hr/>

<!-- =========== START OF FUNCTION SUMMARY =========== -->
<table class="summary" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <th colspan="2">Function Summary</th></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#analyze" class="summary-sig-name"><code>analyze</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Draw conclusions from the clues obtained during the scanning 
phase.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>dict</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#classify" class="summary-sig-name"><code>classify</code></a>(<span class=summary-sig-arg>seq</span>,
          <span class="summary-sig-vararg">*classifiers</span>)</span></code>
<br />
Classify a sequence according to one or several criteria.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>tuple</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#clusters" class="summary-sig-name"><code>clusters</code></a>(<span class=summary-sig-arg>clues</span>,
          <span class=summary-sig-arg>step</span>)</span></code>
<br />
Finds clusters of clues.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#deltas" class="summary-sig-name"><code>deltas</code></a>(<span class=summary-sig-arg>xs</span>)</span></code>
<br />
Computes the differences between the elements of a sequence of 
integers.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#diff_fields" class="summary-sig-name"><code>diff_fields</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Study differences between fields.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#filter_proxies" class="summary-sig-name"><code>filter_proxies</code></a>(<span class=summary-sig-arg>clues</span>,
          <span class=summary-sig-arg>maxdelta</span>)</span></code>
<br />
Detect and merge clues pointing to a proxy cache on the remote 
end.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>str</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#get_digest" class="summary-sig-name"><code>get_digest</code></a>(<span class=summary-sig-arg>clue</span>)</span></code>
<br />
Returns the specified clue's digest.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>int</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#hits" class="summary-sig-name"><code>hits</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Compute the total number of hits in a sequence of clues.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#ignore_changing_fields" class="summary-sig-name"><code>ignore_changing_fields</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Tries to detect and ignore MIME fields with ever changing content.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <a href="Halberd.clues.Clue-module.html" 
        class="link"><code>Clue</code></a>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#merge" class="summary-sig-name"><code>merge</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Merges a sequence of clues into one.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#reanalyze" class="summary-sig-name"><code>reanalyze</code></a>(<span class=summary-sig-arg>clues</span>,
          <span class=summary-sig-arg>analyzed</span>,
          <span class=summary-sig-arg>threshold</span>)</span></code>
<br />
Identify and ignore changing header fields.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#sections" class="summary-sig-name"><code>sections</code></a>(<span class=summary-sig-arg>classified</span>,
          <span class=summary-sig-arg>sects</span>)</span></code>
<br />
Returns sections (and their items) from a nested dict.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code> of <code>slice</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#slices" class="summary-sig-name"><code>slices</code></a>(<span class=summary-sig-arg>start</span>,
          <span class=summary-sig-arg>xs</span>)</span></code>
<br />
Returns slices of a given sequence separated by the specified 
indices.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#sort_clues" class="summary-sig-name"><code>sort_clues</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Sorts clues according to their time difference.</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">        <code>list</code>
</font></td>
  <td><code><span class="summary-sig"><a href="Halberd.clues.analysis-module.html#uniq" class="summary-sig-name"><code>uniq</code></a>(<span class=summary-sig-arg>clues</span>)</span></code>
<br />
Return a list of unique clues.</td></tr>
</table><br />


<!-- =========== START OF FUNCTION DETAILS =========== -->
<table class="details" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="details">
  <th colspan="2">Function Details</th></tr>
</table>

<a name="analyze"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">analyze</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  Draw conclusions from the clues obtained during the scanning 
  phase.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         Unprocessed clues obtained during the scanning stage.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        Coherent list of clues identifying real web servers.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="classify"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">classify</span>(<span class=sig-arg>seq</span>,
          <span class="sig-vararg">*classifiers</span>)</span>
  </h3>
  <p>Classify a sequence according to one or several criteria.</p>
  <p>We store each item into a nested dictionary using the classifiers as 
  key generators (all of them must be callable objects).</p>
  In the following example we classify a list of clues according to 
  their digest and their time difference.
<pre class="doctestblock">
<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>a, b, c = Clue(), Clue(), Clue()
<span class="py-prompt">&gt;&gt;&gt; </span>a.diff, b.diff, c.diff = 1, 2, 2
<span class="py-prompt">&gt;&gt;&gt; </span>a.info[<span class="py-string">'digest'</span>] = <span class="py-string">'x'</span>
<span class="py-prompt">&gt;&gt;&gt; </span>b.info[<span class="py-string">'digest'</span>] = c.info[<span class="py-string">'digest'</span>] = <span class="py-string">'y'</span>
<span class="py-prompt">&gt;&gt;&gt; </span>get_diff = <span class="py-keyword">lambda</span> x: x.diff
<span class="py-prompt">&gt;&gt;&gt; </span>classified = classify([a, b, c], get_digest, get_diff)
<span class="py-prompt">&gt;&gt;&gt; </span>digests = classified.keys()
<span class="py-prompt">&gt;&gt;&gt; </span>digests.sort()  <span class="py-comment"># We sort these so doctest won't fail.</span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> digest <span class="py-keyword">in</span> digests:
<span class="py-prompt">... </span>    <span class="py-keyword">print</span> digest
<span class="py-prompt">... </span>    <span class="py-keyword">for</span> diff <span class="py-keyword">in</span> classified[digest].keys():
<span class="py-prompt">... </span>        <span class="py-keyword">print</span> <span class="py-string">' '</span>, diff
<span class="py-prompt">... </span>        <span class="py-keyword">for</span> clue <span class="py-keyword">in</span> classified[digest][diff]:
<span class="py-prompt">... </span>            <span class="py-keyword">if</span> clue <span class="py-keyword">is</span> a: <span class="py-keyword">print</span> <span class="py-string">'    a'</span>
<span class="py-prompt">... </span>            <span class="py-keyword">elif</span> clue <span class="py-keyword">is</span> b: <span class="py-keyword">print</span> <span class="py-string">'    b'</span>
<span class="py-prompt">... </span>            <span class="py-keyword">elif</span> clue <span class="py-keyword">is</span> c: <span class="py-keyword">print</span> <span class="py-string">'    c'</span>
<span class="py-prompt">...
</span></span>
<span class="py-output">x
  1
    a
y
  2
    b
    c</span></pre>
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>seq</b></code> -
         A sequence to classify.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code> or <code>tuple</code>)</i>
      <dd><code><b>classifiers</b></code> -
         A sequence of callables which return specific fields of the 
        items contained in <a 
        href="Halberd.clues.analysis-module.html#classify" 
        class="link"><code>seq</code></a>
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code> or <code>tuple</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        A nested dictionary in which the keys are the fields obtained 
        by applying the classifiers to the items in the specified 
        sequence.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>dict</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="clusters"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">clusters</span>(<span class=sig-arg>clues</span>,
          <span class=sig-arg>step</span>=<span class=sig-default>3</span>)</span>
  </h3>
  <p>Finds clusters of clues.</p>
  A cluster is a group of at most <code>step</code> clues which only 
  differ in 1 seconds between each other.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         A sequence of clues to analyze
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code> or <code>tuple</code>)</i>
      <dd><code><b>step</b></code> -
         Maximum difference between the time differences of the 
        cluster's clues.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>int</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        A sequence with merged clusters.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>tuple</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="deltas"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">deltas</span>(<span class=sig-arg>xs</span>)</span>
  </h3>
  Computes the differences between the elements of a sequence of 
  integers.
<pre class="doctestblock">
<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>deltas([-1, 0, 1])</span>
<span class="py-output">[1, 1]</span>

<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>deltas([1, 1, 2, 3, 5, 8, 13])</span>
<span class="py-output">[0, 1, 1, 2, 3, 5]</span></pre>
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>xs</b></code> -
         A sequence of integers.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        A list of differences between consecutive elements of <a 
        href="Halberd.clues.analysis-module.html#deltas" 
        class="link"><code>xs</code></a>.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="diff_fields"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">diff_fields</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  Study differences between fields.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         Clues to analyze.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        Fields which were found to be different among the analyzed 
        clues.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="filter_proxies"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">filter_proxies</span>(<span class=sig-arg>clues</span>,
          <span class=sig-arg>maxdelta</span>=<span class=sig-default>3</span>)</span>
  </h3>
  Detect and merge clues pointing to a proxy cache on the remote 
  end.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         Sequence of clues to analyze
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      <dd><code><b>maxdelta</b></code> -
         Maximum difference allowed between a clue's time difference 
        and the previous one.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>int</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        Sequence where all irrelevant clues pointing out to proxy 
        caches have been filtered out.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="get_digest"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">get_digest</span>(<span class=sig-arg>clue</span>)</span>
  </h3>
  <p>Returns the specified clue's digest.</p>
  This function is usually passed as a parameter for <a 
  href="Halberd.clues.analysis-module.html#classify" 
  class="link"><code>classify</code></a> so it can separate clues 
  according to their digest (among other fields).
  <dl><dt></dt><dd>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        The digest of a clue's parsed headers.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>str</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="hits"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">hits</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  Compute the total number of hits in a sequence of clues.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         Sequence of clues.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        Total hits.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>int</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="ignore_changing_fields"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">ignore_changing_fields</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  <p>Tries to detect and ignore MIME fields with ever changing 
  content.</p>
  Some servers might include fields varying with time, randomly, etc. 
  Those fields are likely to alter the clue's digest and interfer with <a 
  href="Halberd.clues.analysis-module.html#analyze" 
  class="link"><code>analyze</code></a>, producing many false positives 
  and making the scan useless. This function detects those fields and 
  recalculates each clue's digest so they can be safely analyzed 
  again.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         Sequence of clues.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code> or <code>tuple</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="merge"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">merge</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  <p>Merges a sequence of clues into one.</p>
  <p>A new clue will store the total count of the clues.</p>
  Note that each <a href="Halberd.clues.Clue-module.html" 
  class="link"><code>Clue</code></a> has a starting count of 1
<pre class="doctestblock">
<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>a, b, c = Clue(), Clue(), Clue()
<span class="py-prompt">&gt;&gt;&gt; </span>sum([x.getCount() <span class="py-keyword">for</span> x <span class="py-keyword">in</span> [a, b, c]])</span>
<span class="py-output">3</span>

<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>a.incCount(5), b.incCount(11), c.incCount(23)</span>
<span class="py-output">(None, None, None)</span>

<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>merged = merge((a, b, c))
<span class="py-prompt">&gt;&gt;&gt; </span>merged.getCount()</span>
<span class="py-output">42</span>

<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>merged == a</span>
<span class="py-output">True</span></pre>
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         A sequence containing all the clues to merge into one.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code> or <code>tuple</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        The result of merging all the passed clues into one.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<a href="Halberd.clues.Clue-module.html" 
        class="link"><code>Clue</code></a>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="reanalyze"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">reanalyze</span>(<span class=sig-arg>clues</span>,
          <span class=sig-arg>analyzed</span>,
          <span class=sig-arg>threshold</span>)</span>
  </h3>
  <p>Identify and ignore changing header fields.</p>
  After initial analysis one must check that there aren't as many 
  realservers as obtained clues. If there were it could be a sign of 
  something wrong happening: each clue is different from the others due 
  to one or more MIME header fields which change unexpectedly.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         Raw sequence of clues.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      <dd><code><b>analyzed</b></code> -
         Result from the first analysis phase.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      <dd><code><b>threshold</b></code> -
         Minimum clue-to-realserver ratio in order to trigger field 
        inspection.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>float</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="sections"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">sections</span>(<span class=sig-arg>classified</span>,
          <span class=sig-arg>sects</span>=<span class=sig-default>None</span>)</span>
  </h3>
  <p>Returns sections (and their items) from a nested dict.</p>
  See also: <a href="Halberd.clues.analysis-module.html#classify" 
  class="link"><code>classify</code></a>
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>classified</b></code> -
         Nested dictionary.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>dict</code>)</i>
      <dd><code><b>sects</b></code> -
         List of results. It should not be specified by the user.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        A list of lists in where each item is a subsection of a nested 
        dictionary.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="slices"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">slices</span>(<span class=sig-arg>start</span>,
          <span class=sig-arg>xs</span>)</span>
  </h3>
  <p>Returns slices of a given sequence separated by the specified 
  indices.</p>
  If we wanted to get the slices necessary to split range(20) in 
  sub-sequences of 5 items each we'd do:
<pre class="doctestblock">
<span class="py-src"><span class="py-prompt">&gt;&gt;&gt; </span>seq = range(20) 
<span class="py-prompt">&gt;&gt;&gt; </span>indices = [5, 10, 15]
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> piece <span class="py-keyword">in</span> slices(0, indices):
<span class="py-prompt">... </span>    <span class="py-keyword">print</span> seq[piece]</span>
<span class="py-output">[0, 1, 2, 3, 4]
[5, 6, 7, 8, 9]
[10, 11, 12, 13, 14]
[15, 16, 17, 18, 19]</span></pre>
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>start</b></code> -
         Index of the first element of the sequence we want to 
        partition.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>int</code>.)</i>
      <dd><code><b>xs</b></code> -
         Sequence of indexes where 'cuts' must be made.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        A sequence of <code>slice</code> objects suitable for 
        splitting a list as specified.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code> of <code>slice</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>

<a name="sort_clues"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">sort_clues</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  Sorts clues according to their time difference.
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="uniq"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">uniq</span>(<span class=sig-arg>clues</span>)</span>
  </h3>
  <p>Return a list of unique clues.</p>
  This is needed when merging clues coming from different sources. 
  Clues with the same time diff and digest are not discarded, they are 
  merged into one clue with the aggregated number of hits.
  <dl><dt></dt><dd>
    <dl><dt><b>Parameters:</b></dt>
      <dd><code><b>clues</b></code> -
         A sequence containing the clues to analyze.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
    <dl><dt><b>Returns:</b></dt>
      <dd>
        Filtered sequence of clues where no clue has the same digest 
        and time difference.
        <br /><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        (type=<code>list</code>)</i>
      </dd>
    </dl>
  </dd></dl>
</td></tr></table>
<br />


<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="Halberd-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" width="100%"></th>
  </tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tr>
    <td align="left"><font size="-2">Generated by Epydoc 2.1 on Wed Jul 18 22:25:57 2007</font></td>
    <td align="right"><a href="http://epydoc.sourceforge.net"
                      ><font size="-2">http://epydoc.sf.net</font></a></td>
  </tr>
</table>
</body>
</html>
